define("disk-system:widget/system/uiRender/menu/contextMenu/contextMenu.js",function(e){var t=(e("base:widget/tools/tools.js"),e("base:widget/libs/jquerypacket.js")),n=e("system-core:data/faceData.js").getData(),i=e("system-core:system/uiService/rMenu/rMenu.js"),o=e("system-core:context/context.js"),r=o.instanceForSystem,a=o.getList(),u=r.message,s={target:"#layoutMain"},c={top:[{title:"查看",variableMenu:function(){var e=[{title:"列表",keyboard:"l"},{title:"缩略图",keyboard:"g"}];return a.isGridMode()?(e[1].icon=["icon-menu-point","icon-menu-point-hover"],e[0].action=function(){u.trigger("system-show-view-mode",{type:"list"})}):(e[0].icon=["icon-menu-point","icon-menu-point-hover"],e[1].action=function(){u.trigger("system-show-view-mode",{type:"grid"})}),e},keyboard:"v"},{title:"排序方式",nextMenu:[{title:"名称",action:function(){a.updateOrder("name")}},{title:"大小",action:function(){a.updateOrder("size")}},{title:"修改日期",action:function(){a.updateOrder("time")}}],display:function(){var e=location.hash;return/^#search\//.test(e)?"disable":!0},keyboard:"o"},{title:"刷新",action:function(){u.trigger("system-refresh")},keyboard:"e"}],middle:[{title:"重新加载页面",action:function(){window.location.reload()},keyboard:"r"},{title:"新建文件夹",icon:"icon-menu-createfolder",action:function(){u.trigger("system-newdir")},display:function(){var e=location.hash;return 1===e.indexOf("list")?!0:"disable"},keyboard:"e"}],bottom:[{title:"会员中心",icon:"icon-menu-vip",action:function(){r.log.send({name:"rmenu_value_added",value:"右键菜单_会员中心"}),window.open(location.protocol+"//yun.baidu.com/buy/center?tag=8&from=rmenu&version=v5")},keyboard:"e"}]},l=function(){if(null!==l.result)return l.result;for(var e=n.contextMenu.blank.sort(function(e,t){return e.index>t.index}),t=function(e,t){if(void 0===e.nextMenu&&void 0===e.variableMenu&&void 0===e.length){if(void 0===e.action)e.action=function(){u.trigger("plugin:"+t)};else if("string"==typeof e.action){var n=e.action;e.action=function(e){u.trigger("plugin:"+t,{run:n,dom:e})}}}else if("string"==typeof e.variableMenu){var n=e.variableMenu;e.variableMenu=function(e,i){u.trigger("plugin:"+t,{dom:e,format:i,run:n})}}},i=0,o=e.length;o>i;i++)if(delete e[i].index,"middle"===e[i].position?c.middle.push(e[i]):"bottom"===e[i].position?c.bottom.push(e[i]):c.top.push(e[i]),e[i].length)for(var r=0,a=e[i].length;a>r;r++)t(e[i][r],e[i].pluginId);else t(e[i],e[i].pluginId);return c.top.push(c.middle),l.result=c.top.concat(c.bottom),l.result};l.result=null,i.bind(t(s.target)[0],l(),{beforeMenu:function(){return t(this).hasClass("ExFGye")||t(this).closest(".ExFGye").length?!1:(a.cancelEidtingDir(),a.cancelFilesSelect(),void r.log.send({name:"web_rightContextMenu_white",value:"右键操作"}))},afterMenu:function(){a.lock(!0)},menuHide:function(){a.lock(!1)}})});
;define("disk-system:widget/system/uiRender/menu/listMenu/listMenu.js",function(e){function i(e,i){return e.disableFun?g.shareDirButtonCheck(e,i,"menu"):!1}function t(e,t){if(void 0===e.nextMenu&&void 0===e.variableMenu&&void 0===e.length){if(void 0===e.action)e.action=function(){r.trigger("plugin:"+t),"string"==typeof e.log&&u.log.send({type:e.log})};else if("string"==typeof e.action){var s=e.action;e.action=function(i){r.trigger("plugin:"+t,{run:s,dom:i}),"string"==typeof e.log&&u.log.send({type:e.log})}}}else if("string"==typeof e.variableMenu){var s=e.variableMenu;e.variableMenu=function(e,i){r.trigger("plugin:"+t,{dom:e,format:i,run:s})}}e.extraCheck&&n.keys(e.extraCheck[0]).length&&(e.display=function(){var t=d.getCheckedItems(),n=i(e,t);if(!n){var s=e.extraCheck;n=c(s,t)}return n===!0?"disable"===e.disabled?"disable":!1:!0})}var n=e("base:widget/libs/underscore.js"),s=e("base:widget/libs/jquerypacket.js"),o=(e("base:widget/tools/tools.js"),e("system-core:data/faceData.js").getData()),r=e("system-core:system/baseService/message/message.js"),l=e("system-core:context/context.js"),a=e("system-core:system/uiService/rMenu/rMenu.js"),d=l.getList(),c=e("disk-system:widget/system/uiRender/checks/checks.js"),u=l.instanceForSystem,g=u.tools.shareDirManager,m=["module","filesLimit","filesType","meta","excludeDirType","path"],v=void 0,f={listTarget:".zJMtAEb",gridTarget:".fyQgAEb",newDirBox:'input[node-type="gsaoPbG1"]'},h={top:[{title:"打开",action:function(){d.isGridMode()?s(this).closest(".cEefyz").find(".uitPe56").trigger("click"):s(this).closest(".AuPKyz").find(".uitPe56").trigger("click")},display:function(){if(d.getCheckedIndexs().length>1)return"disable";var e=s(this).closest(".AuPKyz");return d.isGridMode()&&(e=s(this).closest(".cEefyz")),e.length&&!e.hasClass("open-enable")?"disable":void 0},keyboard:"o"}],middle:[],bottom:[]},p=function(){if(null!==p.result)return p.result;for(var e,i,s=o.contextMenu.file.sort(function(e,i){return e.index-i.index}),r=0,l=s.length;l>r;r++)if(e=s[r],delete e.index,i=[{}],e.conditions&&(i=e.conditions),n.each(m,function(t){var s=e[t];void 0!==s&&(n.each(i,function(e){var i=e[t];void 0===i&&(e[t]=s)}),e[t]=void 0)}),e.extraCheck=i,"middle"===e.position?h.middle.push(e):"bottom"===e.position?h.bottom.push(e):h.top.push(e),e.length)for(var a=0,d=e.length;d>a;a++)t(e[a],e.pluginId);else t(e,e.pluginId);return h.top.push(h.middle),p.result=h.top.concat(h.bottom),p.result};p.result=null;var b=p();a.bind(s(f.listTarget)[0],b,{beforeMenu:function(){var e=s(this).closest(".AuPKyz")[0];if(!e)return!1;d.cancelEidtingDir();var i=parseInt(e.getAttribute("_position"),10);v=i,d.isItemChecked(i)||(d.setSingleItemChecked(i,!0),s(this).closest(".zJMtAEb").is(":visible")?s(this).closest(".NHcGw").find(".AuPKyz").removeClass("rohEvWq"):s(this).closest(".BNfIyPb").find(".cEefyz").removeClass("rohEvWq"),s(e).addClass("rohEvWq")),s(e).removeClass("dscQV9P"),u.log.send({name:"web_rightContextMenu_list",value:"右键操作"})},afterMenu:function(){d.lock(!0)},menuHide:function(){d.lock(!1)}}),a.bind(s(f.gridTarget)[0],b,{beforeMenu:function(){var e=s(this).closest(".cEefyz")[0];if(!e)return!1;d.cancelEidtingDir();var i=parseInt(e.getAttribute("_position"),10),t=s(e).index();v=d.getGridPostiion(i,t),d.isItemChecked(v)||(d.setSingleItemChecked(v,!0),s(this).closest(".BNfIyPb").find(".cEefyz").removeClass("rohEvWq"),s(e).addClass("rohEvWq")),s(e).removeClass("dscQV9P"),u.log.send({name:"web_rightContextMenu_grid",value:"右键操作"})},afterMenu:function(){d.lock(!0)},menuHide:function(){d.lock(!1)}}),s(f.newDirBox).bind("contextmenu",function(e){e.stopPropagation()})});
;define("disk-system:widget/system/fileService/asynFileManager/asynFileManager.js",function(e,a,t){function s(e){this.config=e,this.tiping=!1}var r=e("base:widget/libs/jquerypacket.js"),o=e("base:widget/storage/storage.js"),l=e("system-core:context/context.js").instanceForSystem,i=e("disk-system:widget/system/fileService/asynFileManager/asynFileManagerView.js");s.moveFiles=function(e,a,t){n.doCommonTest(e,"move")&&n.doMoveCopyThing("move",e,a,t)},s.copyFiles=function(e,a,t){n.doCommonTest(e,"copy")&&n.doMoveCopyThing("copy",e,a,t)},s.deleteFiles=function(e,a){n.doCommonTest(e,"delete")&&(n.doDeleteThing("delete",e,a),this.operating=!0)},s.deleteFileSync=function(e,a){n.doCommonTest(e,"delete")&&r.post("/api/filemanager?opera=delete&async=0",{filelist:r.stringify(e)},function(e){e=r.parseJSON(e),e&&0===e.errno?a(1,e):e&&132===e.errno?a(132,e):a(0,e)}).error(function(e){var t=r.parseJSON(e.responseText);a(0,t)})},s.rename=function(e,a,t){n.doCommonTest(e,"rename")&&n.doRename("rename",e,a,t)},s.transferFiles=function(){},s.resolveHasTask=function(e,a,t){var s={},r={},o={};o.taskid=parseInt(e,10),s.operate=a,r.operate=a,r.callback=t,r.async=1,n.doMoveCopySuccCall(o,s,r)},s.transferFile=function(){},s.restore=function(e){var a="restore";n.doCommonTest(e.fidlist,a)&&(n.data.selectedFiles=e.selectedFiles,n.getData(a,e,n.doSuccessCall,n.doFailCall))};var n={};n.data={},n.QUERY_TIMEER=1e3,n.getFileNameByPath=function(e){e=e||"";var a=e.lastIndexOf("/");return e.substring(a+1)},n.getDirFromPath=function(e){return e=e||"",e.substring(0,e.lastIndexOf("/"))},n.doCommonTest=function(e,a){var t=e&&e.length>0;return l.ui.tip(t?{mode:"loading",msg:"正在"+n.getOperateName(a)+"文件，请稍候&hellip;",autoClose:!1}:{mode:"caution",msg:"请选择要"+n.getOperateName(a)+"的文件"}),t},n.doMoveCopyThing=function(e,a,t,s){var o,l,i={},c=[];t="/"===t?"":t;for(var p=0,d=a.length;d>p;p++)o=a[p],l={path:o.path,dest:t,newname:o.newname||n.getFileNameByPath(o.path)},c.push(l);i.filelist=r.stringify(c),i.list=c,i.callback=s,n.getData(e,i,n.doSuccessCall,n.doFailCall)},n.doDeleteThing=function(e,a,t){var s={};s.filelist=r.stringify(a),s.list=a,s.callback=t,n.getData(e,s,n.doSuccessCall,n.doFailCall)},n.doRename=function(e,a,t,s){var o={};o.filelist=r.stringify([{path:a,newname:t}]),o.callback=s,n.getData(e,o,n.doSuccessCall,n.doRenameFailCall)},n.doSuccessCall=function(e,a,t){n.doMoveCopySuccCall(e,a,t)},n.doFailCall=function(e,a,t){if(2===t.async||12!==e.errno&&-8!==e.errno&&-9!==e.errno||e.info&&e.info[0]&&111===e.info[0].errno)if(132===e.errno)c=132,n.callTaskOverCallBack(c,t.callback,e,a,t);else{var s,o=e.errno,i="文件"+n.getOperateName(t.operate)+"失败，请稍候再试",c=3;if(12===o&&"delete"===t.operate?s=i:(12===o&&e.info&&e.info[0]&&e.info[0].errno&&(o=e.info[0].errno),102===o&&e.info&&e.info[0]&&e.info[0].errno&&(o=102===e.info[0].errno?"-102":e.info[0].errno),s=3===o?"一次操作数量不可以超过"+(e.limit||500)+"个":l.errorMsg(o,i,function(){a.removeNest=!0,a.callback=t.callback,a.list=t.list,n.getData(t.operate,a,n.doSuccessCall,n.doFailCall)})),e.flagNetError){if(c=0,!e.flagNetErrorProcess){var p=t.list,d=[];if("delete"===t.operate)for(var u=0,f=p.length;f>u;u++)d.push({from:p[u]});else if("restore"===t.operate){if(n.data.selectedFiles)for(var u=0;u<n.data.selectedFiles.length;u++){var g=n.data.selectedFiles[u];d.push({from:g.path})}}else for(var u=0,f=p.length;f>u;u++)d.push({from:p[u].path});return n.hideTips(),void n.showOtherErrorAsynView("failnet",d,t.operate,a,t)}s="任务进度查询失败，请稍候重试"}n.showErrorCloseTips(s),n.callTaskOverCallBack(c,t.callback,e,a,t)}else{if(a.async=2,a.callback=t.callback,a.list=t.list,"restore"===t.operate)a.url=t.url,a.fidlist=r.stringify(e.faillist);else{var h=e.info,m=[];if(h&&h.length>0)for(var u=0,f=h.length;f>u;u++)0===h[u].errno&&m.push(h[u].path);if(m.length>0&&t.list&&t.list.length>0)if("delete"===t.operate)for(var k=t.list.length-1;k>=0;k--)r.inArray(t.list[k],m)>=0&&t.list.splice(k,1);else for(var k=t.list.length-1;k>=0;k--)r.inArray(t.list[k].path,m)>=0&&t.list.splice(k,1);a.filelist=r.stringify(t.list)}n.getData(t.operate,a,n.doSuccessCall,n.doFailCall)}},n.doRenameFailCall=function(e,a,t){e.flagNetError?n.showErrorCloseTips("网络异常，重名失败，稍后重试下吧"):12===e.errno?n.showRenameAsynView(e,a,t):n.callTaskOverCallBack(0,t.callback,e,a,t)},n.doMoveCopySuccCall=function(e,a,t){e.taskid>0?(n.setTaskProcess(e.taskid,0),n.taskMap.result=e,n.taskMap.params=a,n.taskMap.otherParams=t,o&&o.setItem&&e.taskid&&t.operate&&o.setItem(n.getTaskKey(),e.taskid+"_"+t.operate),n.startGetQueryData(t.operate,e.taskid,n.processSuccCall,n.processFailCall,a)):(n.showSuccTips("文件"+n.getOperateName(t.operate)+"成功"),n.callTaskOverCallBack(1,t.callback,e,a,t))},n.processSuccCall=function(e,a,t){if(0!==e.task_errno)if(n.hideTips(),-32===e.task_errno)e.errno=e.task_errno,n.doFailCall(e,a,t);else switch(t.operate){case"delete":n.showDeleteAsynView(e,a,t);break;case"rename":n.showRenameAsynView(e,a,t);break;default:n.showAsynView(e,a,t)}else if("pending"===e.status)s.tiping||n.showProcessTips("正在"+n.getOperateName(t.operate),0),n.startGetQueryData(t.operate,t.taskid,n.processSuccCall,n.processFailCall,a);else if("running"===e.status){var r=0;r=e.progress?Math.min(Math.max(parseInt(e.progress,10),0),100):n.getTaskProcess(e.taskid),n.setTaskProcess(e.taskid,r),s.tiping||n.showProcessTips("正在"+n.getOperateName(t.operate),r),n.startGetQueryData(t.operate,t.taskid,n.processSuccCall,n.processFailCall,a)}else"success"===e.status&&(o&&o.removeItem&&o.removeItem(n.getTaskKey()),n.showSuccTips("文件"+n.getOperateName(t.operate)+"成功"),"restore"===t.operate&&(e=n.taskMap.ignoreList),n.callTaskOverCallBack(1,n.getLastCallback(),e,a,t))},n.processFailCall=function(e,a,t){e.flagNetErrorProcess=1,n.doFailCall(e,a,t)},n.getData=function(e,a,t,s){if("restore"===e)n.getRestoreAndDeleteData(e,a,t,s);else{var r={},o=1;r.operate=e,r.callback=a.callback,r.list=a.list,delete a.callback,delete a.list,a.async&&(o=a.async,r.async=o,delete a.async);var l="";a.removeNest||(l="&onnest=fail"),o=2,n.fetchData("/api/filemanager?opera="+e+"&async="+o+l,a,t,s,r)}},n.getRestoreAndDeleteData=function(e,a,t,s){var r=a.fidlist?{fidlist:a.fidlist}:{filelist:a.filelist},o=a;o.operate=e;var l=a.url+"&async="+a.async;n.fetchData(l,r,t,s,o)},n.startGetQueryData=function(e,a,t,s,r){setTimeout(function(){n.getQueryData(e,a,t,s,r)},n.QUERY_TIMEER)},n.getQueryData=function(e,a,t,s,r){var o={};o.operate=e,o.taskid=a,o.callback=n.getLastCallback(),n.fetchData("/share/taskquery?taskid="+a,r,t,s,o)},n.fetchData=function(e,a,t,s,o){r.post(e,a,function(i,n,c){if(i&&0===i.errno){t(i,a,o);var p=/taskid=(\d+)&*/i;l.log.send({type:"async",op:"async",action:o.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:1,taskid:i.taskid||(p.test(e)?e.match(p)[1]:0),ajaxerrno:i.errno,ajaxerrmsg:l.errorMsg(i.errno),ajaxstatus:c.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:r.stringify(a),ajaxdata:r.stringify(i),file:r.stringify(a.filelist)})}else if(132===i.errno)s(i,a,o);else{s(i,a,o);var p=/taskid=(\d+)&*/i;l.log.send({type:"async",op:"async",action:o.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:0,taskid:i.taskid||(p.test(e)?e.match(p)[1]:0),ajaxerrno:i.errno,ajaxerrmsg:l.errorMsg(i.errno,"未知错误"),ajaxstatus:c.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:r.stringify(a),ajaxdata:r.stringify(i),file:r.stringify(a.filelist)})}},"json").error(function(t,i,n){var c;try{c=r.parseJSON(t.responseText)}catch(p){}c||(c={}),c.flagNetError=1,s(c,a,o);var d=/taskid=(\d+)&*/i;l.log.send({type:"async",op:"async",action:o.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:0,taskid:c.taskid||(d.test(e)?e.match(d)[1]:0),ajaxerrno:c.errno||31021,ajaxerrmsg:l.errorMsg(c.errno||31021),ajaxstatus:n.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:r.stringify(a),ajaxdata:r.stringify(c),file:r.stringify(a.filelist)})})},n.hideTips=function(){l.ui.hideTip()},n.showSuccTips=function(e){l.ui.tip({mode:"success",msg:e})},n.showErrorTips=function(e){l.ui.tip({mode:"caution",msg:e})},n.showLoadingTips=function(e){l.ui.tip({mode:"loading",msg:e,autoClose:!1})},n.showProcessTips=function(e,a){var t='<span class="asyn-tip-process" style="float: right;width: 180px;height: 5px;background: #1b71f0;margin: 17px 0 0 17px;border-radius: 4px;overflow: hidden;"><span class="asyn-tip-process-inner" style="float: left;display: inline-block;background: #fff;height: 5px;font-size: 0;width:'+a+'%"></span></span>';l.ui.tip({mode:"none",msg:'<span style="float: left;">'+e+a+"%</span>"+t,autoClose:!1,hasClose:!1})},n.showErrorCloseTips=function(e){return e?void l.ui.tip({mode:"caution",msg:e,autoClose:!1,hasClose:!0}):void l.ui.hideTip()},n.taskMap={},n.setTaskProcess=function(e,a){var t=n.taskMap[e];t||(t={},n.taskMap[e]=t),t.process=a},n.getTaskProcess=function(e){var a=n.taskMap[e],t=0;return a&&(t=a.process||0),t},n.getLastCallback=function(){var e=n.taskMap;return e.otherParams&&e.otherParams.callback?e.otherParams.callback:null},n.getOperateName=function(e){var a=n.taskMap,t="操作";switch(e||a.otherParams&&a.otherParams.operate&&(e=a.otherParams.operate),e){case"copy":t="复制";break;case"move":t="移动";break;case"delete":t="删除";break;case"transfer":t="转存";break;case"rename":t="重命名";break;case"restore":t="还原"}return t},n.addTaskObj=function(e,a,t,s,r,o,l){var i=n.taskMap;i.currentTypeIndex=e||0,i.currentIndex=a||0,i.defaultList=t,i.repeatFileList=s,i.repeatFolderList=r;var c=i.notFoundList;c instanceof Array||(c=[],i.notFoundList=c),Array.prototype.push.apply(c,o);var p=i.otherList;p instanceof Array||(p=[],i.otherList=p),Array.prototype.push.apply(p,l)},n.hasNext=function(){var e,a=n.taskMap,t=a.currentTypeIndex,s=a.currentIndex;if(0===t)e=a.repeatFileList;else{if(1!==t)return!1;e=a.repeatFolderList}return s>=e.length?(a.currentTypeIndex++,a.currentIndex=0,0===t&&a.repeatFolderList.length>0?!0:!1):!0},n.doNext=function(){if(n.hasNext()){var e,a,t=n.taskMap,s=t.currentTypeIndex,r=t.currentIndex;0===s?(e=t.repeatFileList,a=0):(e=t.repeatFolderList,a=1),n.showAsynViewItem(e[t.currentIndex++],e.length-r-1,a)}else n.doAllDone()},n.doNextAll=function(e){for(var a,t=n.taskMap,s=t.currentTypeIndex,r=t.currentIndex,o=0===s?t.repeatFileList:t.repeatFolderList,l=r,i=o.length;i>l;l++)a=o[l],a.from_meta.isdir&&"overwrite"===e?a.ignore=1:a.ondup=e;t.currentIndex=o.length,0===s?n.doNext():n.doAllDone()},n.doRetryTask=function(){l.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});var e=n.taskMap;n.doCommonDone(e,e.otherList,n.getLastCallback()),e.otherList=[]},n.doRetryDeleteTask=function(){l.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});for(var e=n.taskMap,a=e.otherParams,t=e.otherList,s=[],o={},i=0,c=t.length;c>i;i++)s.push(t[i].path);e.otherList=[],o.list=s,o.filelist=r.stringify(s),o.async=2,o.callback=a.callback,n.getData(a.operate,o,n.doSuccessCall,n.doFailCall)},n.doNetErrorRetryTask=function(e,a,t,s){l.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1}),t.async=s.async,"restore"===a?t.url=s.url:(t.list=s.list,delete t.fidlist),t.callback=s.callback,n.getData(a,t,n.doSuccessCall,n.doFailCall)},n.doAllDone=function(){var e=n.taskMap,a=e.defaultList,t=e.repeatFileList,s=e.repeatFolderList,r=[],o=(e.otherParams,n.getLastCallback());Array.prototype.push.apply(r,a),Array.prototype.push.apply(r,t),Array.prototype.push.apply(r,s),n.doCommonDone(e,r,o)},n.doCommonDone=function(e,a,t){l.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});for(var s,i,c=e.otherParams,p=[],d={},u=[],f=[],g=0,h=a.length;h>g;g++)s=a[g],s.ignore?u.push(s.from):(i=n.getDirFromPath(s.to),i="/"===i?"":i,p.push({path:s.from,dest:i,newname:n.getFileNameByPath(s.from),ondup:s.ondup||"fail"}),"restore"===c.operate&&s.fs_id&&f.push({fid:s.fs_id,ondup:s.ondup||"fail"}));if(n.taskMap.ignoreList=u,p.length>0)d.async=2,d.callback=c.callback,"restore"===c.operate?(d.url=c.url,d.filelist=r.stringify(f)):(d.filelist=r.stringify(p),d.list=p),n.getData(c.operate,d,n.doSuccessCall,n.doFailCall);else{o&&o.removeItem&&o.removeItem(n.getTaskKey());var m=e.repeatFileList.length+e.repeatFolderList.length;e.ignoreList.length<m?n.showSuccTips("文件"+n.getOperateName()+"成功"):n.hideTips(),n.callTaskOverCallBack(1,t,e.result,e.params,e.otherParams)}},n.doAllNotFound=function(){var e=n.taskMap,a=e.notFoundList;return a instanceof Array&&a.length>0?(n.showOtherErrorAsynView("notfound",a,e.otherParams.operate,e.params,e.otherParams),e.notFoundList=[],!0):!1},n.doAllFail=function(){var e=n.taskMap,a=e.otherList;return a instanceof Array&&a.length>0?(n.showOtherErrorAsynView("fail",a,e.otherParams.operate,e.params,n.getLastCallback()),!0):!1},n.showDeleteAsynView=function(e,a,t){if(!e.list||e.list.length<=0)return delete e.errno,void n.doFailCall(e,a,t);for(var s,r=e.list,o=[],l=[],i=0,c=r.length;c>i;i++)s=r[i],s.from=s.path,-9===s.error_code?o.push(s):l.push(s);n.addTaskObj(0,0,[],[],[],o,l),n.doNext()},n.showRenameAsynView=function(e,a,t){if(12===e.errno||-8===e.errno||-30===e.task_errno){var s={title:"提示",contentTitle:"此目录下已存在同名文件，是否要保存两个文件",okText:"保留两个文件",cancelText:"取消",okCall:function(){a.ondup="newcopy",a.callback=t.callback,a.async=2,n.getData("rename",a,n.doSuccessCall,n.doRenameFailCall)},cancelCall:function(){var s=n.taskMap;s.otherParams=t,s.result=e,s.params=a,n.callTaskOverCallBack(2,n.getLastCallback(),e,a,t)}};n.hideTips(),i.showException(s)}else delete e.errno,n.doFailCall(e,a,t)},n.showAsynView=function(e,a,t){if(!e.list||e.list.length<=0)return delete e.errno,void n.doFailCall(e,a,t);var s,r=e.list,o=[],l=[],i=[],c=[],p=[];if(r instanceof Object){for(var d=0,u=r.length;u>d;d++)s=r[d],-8===s.error_code?s.from_meta&&s.to_meta&&(s.from_meta.isdir&&s.to_meta.isdir?i.push(s):s.from_meta.isdir||s.to_meta.isdir?(s.ondup="newcopy",o.push(s)):l.push(s)):-9===s.error_code?c.push(s):p.push(s);n.addTaskObj(0,0,o,l,i,c,p),n.doNext()}},n.showOtherErrorAsynView=function(e,a,t,s,r){var o={};if(o.title="提示","restore"===r.operate)for(var l=this.data.selectedFiles,c=0;c<l.length;c++)for(var p=l[c],d=0;d<a.length;d++){var u=a[d];p.fs_id===u.fs_id&&(u.from=p.server_filename,u.to=p.server_filename,u.isdir=p.isdir)}("fail"===e||"failnet"===e)&&(o.contentTitle='网络异常，<span class="asyn-red">'+a.length+"</span>个文件"+n.getOperateName(t)+"失败，是否重试？",o.okText="重试",o.cancelText="取消"),"fail"===e?(o.okCall="delete"===t?function(){n.doRetryDeleteTask()}:function(){n.doRetryTask()},o.cancelCall=function(){n.taskMap.otherList=[],n.callTaskOverCallBack(1,n.getLastCallback())}):"failnet"===e?(o.okCall=function(){n.doNetErrorRetryTask(a,t,s,r)},o.cancelCall=function(){}):(o.cancelText="我知道了",o.contentTitle='有<span class="asyn-red">'+a.length+"</span>个文件的源文件找不到了，操作未完成",o.cancelCall=function(){n.callTaskOverCallBack(1,n.getLastCallback())}),o.flagRepeat=!1,o.errorList=a,i.showException(o)},n.showAsynViewItem=function(e,a,t){var s=e.from_meta,r=(e.to_meta,{}),o=t?"夹":"",l=n.getOperateName();if(r.title=l+"文件",r.contentTitle=l+"的位置已经包含了同名的文件"+o+"，请选择你的操作：",r.plusText=s.isdir?"跳过":"替换文件",r.plusCall=function(a){s.isdir&&(e.ignore=1),e.ondup="overwrite",a?n.doNextAll(e.ondup):n.doNext()},r.okCall=function(a){e.ondup="newcopy",a?n.doNextAll(e.ondup):n.doNext()},r.cancelCall=function(){var e=n.taskMap,a=e.otherParams,t=e.result,s=e.params;n.callTaskOverCallBack(2,n.getLastCallback(),t,s,a)},r.okText="保留两个文件"+o,r.cancelText="取消",a>0&&(r.checkboxMsg='为其余的<span class="asyn-red">'+a+"</span>个重名文件"+o+"都执行此操作"),r.flagRepeat=!0,r.repeatToMsg="已有文件"+o+"：",r.repeatFrmMsg="正在"+l+"的文件"+o+"：","还原"===l&&this.data.selectedFiles)for(var c=this.data.selectedFiles,p=0;p<c.length;p++){var d=c[p];d.fs_id===e.fs_id&&(e.from=d.path,e.to=d.path)}r.errorList=e,i.showException(r)},n.callTaskOverCallBack=function(e,a,t,s,r){return n.doAllFail()?void n.hideTips():(n.doAllNotFound()&&n.hideTips(),"function"==typeof a&&a.call(null,e,t,s,r,n.taskMap.ignoreList),void((1===e||2===e||3===e)&&o&&o.removeItem&&o.removeItem(n.getTaskKey())))},n.getTaskKey=function(){return"asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,"")},t.exports=s});
;define("disk-system:widget/system/fileService/fileManagerApi/fileManagerApi.js",function(e,r,t){var a=e("base:widget/libs/jquerypacket.js"),i=e("system-core:context/context.js").instanceForSystem,s=e("system-core:system/baseService/message/message.js"),n=e("disk-system:widget/system/fileService/asynFileManager/asynFileManager.js"),o={FILE_NAME_REG:/[\\\/\:\*\?'<>\|]/i,KEYWORDS_REG:function(){var e=i.pluginControl.getFaceData(),r=e.button,t=["共享给我的文件夹","我的卡包"];for(var a in r)if(r.hasOwnProperty(a))for(var s=r[a],n=0;n<s.length;n++){var o=s[n].excludeDirType;if(o)for(var l=o.split(","),c=0;c<l.length;c++)t.indexOf(l[c])<0&&t.push(l[c])}return new RegExp("^"+t.join("|")+"$")}(),resolveFileName:function(e){var r="";if(0===e.indexOf("/")&&(e=e.slice(1)),o.FILE_NAME_REG.test(e)?r="文件名不能包含以下字符：<,>,|,*,?,,/":o.KEYWORDS_REG.test(e)&&(r="文件名含有关键字，换一个试试吧！"),!r)if(e.length>0){for(var t=0,a=0;t<e.length;t++)e.charCodeAt(t)<128?a++:a+=2;a>255&&(r="文件(夹)名称长度不能超过255字节")}else r="文件(夹)名称不能为空，请输入文件名称";return r},resolveNewName:function(e,r,t){return t?e.substring(0,e.lastIndexOf("/"))+"/"+r:r}},l={COPY:"copy",MOVE:"move",DELETE:"delete",UPLOAD:"upload",createDirFlag:!1,sendFileMoveCopyApi:function(e,r,t,s,n){for(var o,l,c=[],f=null,g=0,p=r.length;p>g;g++)f=r[g].path,o=i.tools.baseService.parseDirPath(f),l=i.tools.baseService.parseDirFromPath(f),c.push({path:o,dest:t,newname:l});a.post("/api/filemanager?channel=chunlei&clienttype=0&web=1&opera="+e,{filelist:a.stringify(c)},s).error(n)},sendCreateNewFileApi:function(e,r,t,s,n,l){var c,f,g=i.tools.baseService.parseDirFromPath(e),p="";if(o.FILE_NAME_REG.test(g))return p="文件名不能包含以下字符：<,>,|,*,?,,/",l(p),!1;if(g.length>0){for(f=0,c=0;f<g.length;f++)g.charCodeAt(f)<128?c++:c+=2;c>255&&(p="文件(夹)名称长度不能超过255字节",l(p))}else p="文件(夹)名称不能为空，请输入文件名称",l(p);p||a.post("/api/create?a=commit",{path:e,isdir:t,size:r,block_list:s?'["'+s+'"]':"[]",method:"post"},n)},createNewDir:function(e,r,t){var s=this;if(!s.createDirFlag){s.createDirFlag=!0;var n=o.resolveFileName(t);return n?(r(1,n),s.createDirFlag=!1):void a.post("/api/create?a=commit",{path:e,isdir:1,block_list:"[]"},function(e){e&&0==e.errno?r(0,"创建文件夹成功",e):(n=i.errorMsg(e.errno,"发生未知错误，请稍后重试"),r(1,n,e))},"json").fail(function(e){var t;try{t=a.parseJSON(e.responseText)}catch(s){}t=t||{},n=i.errorMsg(t.errno,"发生未知错误，请稍后重试"),r(1,n,t)}).always(function(){s.createDirFlag=!1})}},deleteFiles:function(e,r,t){var a=t?n.deleteFileSync:n.deleteFiles;a.call(null,e,function(e,t){if(1===e)s.trigger("quota-change"),r(0,"删除成功",t);else{var a=i.errorMsg(t.errno,"发生未知错误，请稍后重试");r(132===e?132:1,a,t||{})}})},reName:function(e,r,t){var a=this;if(!a.createDirFlag){a.createDirFlag=!0;var s=o.resolveFileName(t);if(s)r(1,s),a.createDirFlag=!1;else{var l=o.resolveNewName(e,t);n.rename(e,l,function(e,t){1===e||2===e?(t.status=e,r(0,"重命名成功",t)):(s=-8===t.errno||-9===t.errno?"名称已在使用，请使用其他名称":i.errorMsg(t.errno,"重命名失败，请稍候重试"),r(1,s,t)),a.createDirFlag=!1})}}}};t.exports=l});
;define("disk-system:widget/system/fileService/asynFileManager/asynFileManagerView.js",function(e,n,i){function a(e){if(!(e.length&&e.server_filename&&e.isdir))return"";for(var n,i='<ul class="asyn-view-content asyn-view-repeat-content">',a=e.length>10,s=a?10:e.length,t=0;s>t;t++)n=e[t],n.server_filename=n.from,n.isdir=0,i+='<li><span class="global-icon-16 global-icon-16-'+p.encodeHTML(c(n))+'"></span>'+p.encodeHTML(p.getFileNameByPath(n.from))+" </li>";return a&&(i+='<li class="asyn-view-more global-clearfix"><span class="asyn-view-point"></span><span class="asyn-view-point"></span><span class="asyn-view-point"></span></li>'),i+="</ul>"}function s(e,n,i){var a=e.to_meta,s=e.from_meta;return a.path=e.to,s.path=e.from,a.server_filename=p.getFileNameByPath(a.path),s.server_filename=p.getFileNameByPath(s.path),'<div class="asyn-view-content">'+t(a,n)+t(s,i)+"</div>"}function t(e,n){var i='<div class="asyn-view-content-item"><span class="asyn-view-tip-msg">'+n+'</span><div class="asyn-view-tip-info"><span class="asyn-view-tip-icon global-icon-16 global-icon-16-'+p.encodeHTML(c(e))+'"></span><span class="asyn-view-tip-name">'+p.encodeHTML(e.server_filename)+'</span></div><span class="asyn-view-tip-date">';return 1!==parseInt(e.isdir,10)&&(i+="大小："+p.toFriendlyFileSize(e.size)+"&nbsp;&nbsp;"),i+="修改日期："+p.parseDate(e.mtime)+"</span></div>"}function l(e){var n=[].slice.call(arguments,1);return n[0]?(e?s:a).apply(null,n)||"":""}function o(e,n){return e?'<div class="asyn-view-checkbox '+(n?"on":"")+'"><span class="global-icon-checkbox"></span>'+e+"</div>":""}function c(e){return 1===+e.isdir?"dir":p.getFileCategory(String(e.server_filename))||""}var r=e("system-core:context/context.js").instanceForSystem,p=e("base:widget/tools/tools.js"),d="alert-dialog-asyn-view";i.exports.showException=function(e){function n(){a(),e.okCall(s())}function i(){a(),e.cancelCall()}function a(){u.$dialog.removeClass(d),u.hide()}function s(){return p?u.$dialog.find(".asyn-view-checkbox").hasClass("on"):void 0}var t=e.title||"确定",c=l(e.flagRepeat,e.errorList,e.repeatToMsg,e.repeatFrmMsg),p=o(e.checkboxMsg,e.checkboxChecked),v=['<div class="dialog-asyn-view">',"<h4>"+e.contentTitle+"</h4>",c,p,"</div>"],g=[];e.plusText&&g.push({type:"big",color:"blue",name:"confirm",title:e.plusText,click:function(){a(),e.plusCall(s())}}),e.okText&&g.push({type:"big",color:"blue",name:"confirm",title:e.okText,padding:["36px","36px"],click:n}),g.push({type:"big",name:"cancel",title:e.cancelText,padding:["36px","36px"],click:i});var u=r.ui.window({title:t,body:v.join(""),buttons:g,onClose:i});u.show(),u.$dialog.addClass(d),u.$dialog.find(".asyn-view-checkbox").click(function(){$(this).toggleClass("on")})}});
;define("disk-system:widget/system/util/selection.js",function(t,e,n){n.exports.setSelectionRange=function(t,e,n){function a(){if(e===n){var a=!(!window.attachEvent||-1!==navigator.userAgent.indexOf("Opera"));a&&window.setTimeout(function(){t.blur(),window.setTimeout(function(){t.focus()},0)},0)}}if(t){if(e=0>e?0:e,n=e>n?e:n,t.setSelectionRange)return t.focus(),t.setSelectionRange(e,n),void a();if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveStart("character",e),r.moveEnd("character",n-e),r.select(),a()}}},n.exports.getSelectionRange=function(t){var e={text:"",start:0,end:0};if(t.setSelectionRange)return e.start=t.selectionStart,e.end=t.selectionEnd,e.text=e.start!==e.end?t.value.substring(e.start,e.end):"",e;if(document.selection){var n,a=document.selection.createRange(),r=document.body.createTextRange();r.moveToElementText(t),e.text=a.text,e.bookmark=a.getBookmark();try{for(n=0;r.compareEndPoints("StartToStart",a)<0&&0!==a.moveStart("character",-1);n++)"\n"===t.value.charAt(n)&&n++;e.start=n,e.end=e.text.length+e.start}catch(o){var c=document.selection.createRange();c.setEndPoint("StartToStart",t.createTextRange()),e.end=c.text.length,e.start=e.end-a.text.length}}return e}});
;define("disk-system:widget/system/util/fileSystem/fileSystem.js",function(e,r,t){function n(){z("shareDir",IDBKeyRange.only([1,1])).then(function(e){e.length&&(p=e.map(function(e){return console.log("[SHARE DIR DEBUG] get share dir path:",e.path),new RegExp("^"+e.path+"/?")}))})}function i(e,r){if("[object Array]"===Object.prototype.toString.call(e)){var t=null;switch(r){case!0:t=function(e){e.share=1};break;case void 0:t=function(e){o(e.path)&&(e.share=1)};break;default:return}e.forEach(t)}}function o(e){for(var r=0,t=p.length;t>r;r++)if(p[r].test(e))return!0;return!1}function a(){var e=d.db.transaction(h.fileList,"readonly"),r=e.objectStore(h.fileList);try{r.index("shareDir")}catch(t){return!1}return!0}var s=e("base:widget/libs/jquerypacket.js"),u=e("base:widget/tools/tools.js"),c=e("disk-system:widget/data/yunData.js").get(),l=e("system-core:context/context.js").instanceForSystem,f=e("base:widget/storage/storage.js"),d={name:"FileSystem",version:1,db:null,isAvailable:!1,isOpen:!1,ajaxApi:"/api/filediff",throttleTime:100,syncTime:3e5,fileLimit:4e4},h={fileList:"fileList",cursor:"cursor",owner:"owner"},m={path:["path",["parent_path","isdir","server_mtime"],{unique:!1}],pathAndFileName:["pathAndFileName",["parent_path","isdir","server_filename"],{unique:!1}],pathAndSize:["pathAndSize",["parent_path","isdir","size"],{unique:!1}],category:["category",["category","isdir","server_mtime"],{unique:!1}],categoryAndFileName:["categoryAndFileName",["category","isdir","server_filename"],{unique:!1}],categoryAndSize:["categoryAndSize",["category","isdir","size"],{unique:!1}],shareDir:["shareDir",["share","isdir"],{unique:!1}]},p=[],v=function(e,r,t){return new Promise(function(n,i){r?e[r]=function(e){n(e)}:e.onsuccess=function(e){n(e)},t?e[t]=function(e){i(e)}:e.onerror=function(e){i(e)}})},g=function(e,r){var t=indexedDB.open(e,r);return t.onupgradeneeded=function(e){var r,t=e.target.result,n=e.target.transaction;r=t.objectStoreNames.contains(h.fileList)?n.objectStore(h.fileList):t.createObjectStore(h.fileList,{keyPath:"path"});for(var i in m)m.hasOwnProperty(i)&&!r.indexNames.contains(i)&&r.createIndex.apply(r,m[i]);t.objectStoreNames.contains(h.cursor)||t.createObjectStore(h.cursor,{keyPath:"cursor"}),t.objectStoreNames.contains(h.owner)||t.createObjectStore(h.owner,{keyPath:"uk"})},v(t)},y=function(e){var r=e.lastIndexOf("/");return r>0?e.slice(0,r):"/"},b=function(e,r){var t=d.db.transaction(e,"readwrite"),n=t.objectStore(e);for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.path&&(o.parent_path=y(o.path)),o.isdelete?n["delete"](o.path):n.put(o)}return v(t,"oncomplete")},S=function(e){var r=d.db.transaction(e,"readonly"),t=r.objectStore(e),n=t.openCursor();return v(n)},A=function(e){var r=d.db.transaction(e,"readonly"),t=r.objectStore(e),n=t.count();return v(n)},j=function(e){var r=d.db.transaction(e,"readwrite"),t=r.objectStore(e),n=t.clear();return v(n)},_=function(e,r){return j(e).then(function(){return b(e,r)})},P=function(){return S(h.owner).then(function(e){var r=e.target.result;return r&&r.value.uk===c.uk?void 0:Promise.all([j(h.fileList),j(h.cursor)])}).then(function(){return _(h.owner,{uk:{uk:c.uk}})})},w=function(e,r){return new Promise(function(t,n){s.getJSON(e,r,function(e){e&&0===e.errno?t(e):n(e)}).error(function(e){n(e)})})},k=!0,x=u.throttle(function(){d.isAvailable||localStorage.getItem("block_uk_"+c.uk)||A(h.fileList).then(function(e){var r=e.target.result;return r>d.fileLimit||a()===!1?(localStorage.setItem("block_uk_"+c.uk,1),indexedDB.deleteDatabase("FileSystem"),Promise.reject(r)):Promise.resolve(r)}).then(function(){return S(h.cursor)}).then(function(e){var r={cursor:"null"},t=e.target.result;if(t)r.cursor=t.value.cursor;else{if(!k)return Promise.reject(!1);k=!1}return l.log.send({name:"filediff",sendServerLog:!1}),w(d.ajaxApi,r)}).then(function(e){var r=Promise.resolve(!0);return e.reset&&(r=j(h.fileList)),r.then(function(){return Promise.resolve(e)})}).then(function(e){return new Promise(function(r){setTimeout(function(){for(var t in e.entries)if(e.entries.hasOwnProperty(t)){var n=e.entries[t];1===n.isdir&&1===n.share&&(n.is_root=1)}r(e)},0)})}).then(function(e){return Promise.all([b(h.fileList,e.entries),_(h.cursor,{cursor:{cursor:e.cursor}})]).then(function(){return Promise.resolve(e)})}).then(function(e){e.has_more?x():(d.isAvailable=!0,N(),n())},function(){})},d.throttleTime,d.throttleTime),D=function(){return"object"!=typeof indexedDB?!1:"function"!=typeof Promise?!1:"yun.baidu.com"===location.hostname?!1:navigator.userAgent.indexOf("Edge")>-1?!1:f.overwrite&&!f.indexedDBCall?!1:!0},L=function(){D()&&g(d.name,d.version).then(function(e){d.db=e.target.result,d.isOpen=!0},function(){d.isOpen=!1,d.isAvailable=!1}).then(function(){return P()}).then(function(){x()},function(){})},z=function(e,r){var t=d.db.transaction(h.fileList,"readonly"),n=t.objectStore(h.fileList),i=n.index(e),o=i.openCursor(r,"next");return new Promise(function(e,r){var t=[];o.onsuccess=function(r){var n=r.target.result;n?(t.push(n.value),n["continue"]()):e(t)},o.onerror=function(e){r(e)}})},O=function(e,r){var t=d.db.transaction(h.fileList,"readonly"),n=t.objectStore(h.fileList),i=n.index(e),o=i.count(IDBKeyRange.bound([r,1,-1/0],[r,1,String.fromCharCode(65535)]));return v(o).then(function(e){return Promise.resolve(e.target.result)})},C=function(e,r){return e&&r?e[0]===r[0]?C(e.slice(1),r.slice(1)):/[a-zA-Z]/.test(e[0])&&/[a-zA-Z]/.test(r[0])||/\W/.test(e[0])&&/\W/.test(r[0])?e[0].localeCompare(r[0]):indexedDB.cmp(e[0],r[0]):e.localeCompare(r)},I=function(e){var r=function(e){var r=100,t=location.protocol+"//pcs.baidu.com/rest/2.0/pcs/thumbnail?method=generate&app_id=250528",n={path:e,quality:r};for(var i in n)if(n.hasOwnProperty(i)){var o=encodeURIComponent(n[i]);t+="&"+i+"="+o}return t};if("[object Array]"===Object.prototype.toString.call(e))for(var t=e.length,n=0;t>n;n++)if(e[n].category&&(1===e[n].category||3===e[n].category)&&e[n].path){var i=r(e[n].path);e[n].thumbs={icon:i+"&size=c60_u60",url1:i+"&size=c140_u90",url2:i+"&size=c360_u270",url3:i+"&size=c850_u580"}}return e},B={"/api/list":function(e,r){var t=m.path[0];t="name"===r.order?m.pathAndFileName[0]:"size"===r.order?m.pathAndSize[0]:m.path[0];var n=o(r.dir),a=[z(t,IDBKeyRange.bound([r.dir,1,-1/0],[r.dir,1,String.fromCharCode(65535)]))];return r.folder||a.push(z(t,IDBKeyRange.bound([r.dir,0,-1/0],[r.dir,0,String.fromCharCode(65535)]))),Promise.all(a).then(function(e){var o=[],a=[];o=e[0],e.length>1&&(a=e[1]),"name"===r.order&&(o.sort(function(e,r){return C(e.server_filename,r.server_filename)}),a.sort(function(e,r){return C(e.server_filename,r.server_filename)})),r.desc?(o.reverse(),a.reverse()):"size"===r.order&&o.reverse();var s=[0];if(r.folder)for(var u=0;u<o.length;u++){var c=o[u];s.push(O(t,c.path))}return Promise.all(s).then(function(e){for(var t=1;t<e.length;t++)o[t-1].dir_empty=e[t]>0?0:1;var s=o.concat(a);return r.page&&r.page>1&&(s=s.slice((r.page-1)*r.num+1)),i(s,n),s=I(s),Promise.resolve({errno:0,list:s,has_more:!1})})})},"/api/categorylist":function(e,r){var t=m.category[0];return t="name"===r.order?m.categoryAndFileName[0]:"size"===r.order?m.categoryAndSize[0]:m.category[0],z(t,IDBKeyRange.bound([parseInt(r.category,10),0,-1/0],[parseInt(r.category,10),0,String.fromCharCode(65535)])).then(function(e){var t=e;return"name"===r.order&&t.sort(function(e,r){return C(e.server_filename,r.server_filename)}),r.desc&&t.reverse(),r.page&&r.page>1&&(t=t.slice((r.page-1)*r.num+1)),i(t),t=I(t),Promise.resolve({errno:0,info:t,has_more:!1})})}},N=u.throttle(function(){x()},d.syncTime,d.syncTime),q={isAvailable:function(){return d.isAvailable&&d.isOpen},invalidCache:function(){q.isAvailable()&&N(),d.isAvailable=!1},hasApi:function(e){return q.isAvailable()&&B.hasOwnProperty(e)},getApi:function(e,r){return q.hasApi(e)?B[e](e,r):Promise.reject({})}};L(),t.exports=q});
;define("disk-system:widget/system/util/imageSystem/imageSystem.js",function(e,n,t){var i=e("base:widget/tools/tools.js"),r=e("disk-system:widget/data/yunData.js").get(),o=window.URL&&window.URL.revokeObjectURL.bind(window.URL)||window.webkitURL&&window.webkitURL.revokeObjectURL.bind(window.webkitURL)||window.revokeObjectURL,a=window.URL&&window.URL.createObjectURL.bind(window.URL)||window.webkitURL&&window.webkitURL.createObjectURL.bind(window.webkitURL)||window.createObjectURL,u={name:"ImageSystem",version:1,db:null,isAvailable:!1,isOpen:!1},s={imageList:"imageList",owner:"owner"},c={imageWithSize:["imageWithSize",["fs_id","w","h"],{unique:!0}]},d=function(e,n,t){return new Promise(function(i,r){n?e[n]=function(e){i(e)}:e.onsuccess=function(e){i(e)},t?e[t]=function(e){r(e)}:e.onerror=function(e){r(e)}})},w=function(e,n){var t=indexedDB.open(e,n);return t.onupgradeneeded=function(e){var n,t=e.target.result,i=e.target.transaction;n=t.objectStoreNames.contains(s.imageList)?i.objectStore(s.imageList):t.createObjectStore(s.imageList,{autoIncrement:!0});for(var r in c)c.hasOwnProperty(r)&&!n.indexNames.contains(r)&&n.createIndex.apply(n,c[r]);t.objectStoreNames.contains(s.owner)||t.createObjectStore(s.owner,{keyPath:"uk"})},d(t)},b=function(){var e=!!window.ProgressEvent,n=!!window.FormData,t=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;return e&&n&&t},f=function(){return!!a},g=function(e,n){for(var t=u.db.transaction(e,"readwrite"),i=t.objectStore(e),r=0;r<n.length;r++)i.put(n[r]);return d(t,"oncomplete")},m=function(e){var n=u.db.transaction(e,"readonly"),t=n.objectStore(e),i=t.openCursor();return d(i)},l=function(e){var n=u.db.transaction(e,"readwrite"),t=n.objectStore(e),i=t.clear();return d(i)},v=function(e,n){return l(e).then(function(){return g(e,n)})},L=function(){return m(s.owner).then(function(e){var n=e.target.result;return n&&n.value.uk===r.uk?void 0:l(s.imageList)}).then(function(){return v(s.owner,[{uk:r.uk}])})},h=function(){return"object"!=typeof indexedDB?!1:"function"!=typeof Promise?!1:"yun.baidu.com"===location.hostname?!1:b()&&f()?navigator.userAgent.indexOf("Edge")>-1?!1:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?!1:!0:!1},R=function(){h()&&w(u.name,u.version).then(function(e){u.db=e.target.result,u.isOpen=!0},function(){u.isOpen=!1,u.isAvailable=!1}).then(function(){return L()}).then(function(){u.isAvailable=!0},function(){})},p=function(e,n){var t=u.db.transaction(s.imageList,"readonly"),i=t.objectStore(s.imageList),r=i.index(e),o=r.get(n);return d(o)},j=function(e){var n=i.getParam("size",e),t=/c(\d+)/gi,r=/u(\d+)/gi,o=t.exec(n);t=o?Number(o[1])||0:Number(i.getParam("height",e))||0;var a=r.exec(n);return r=a?Number(a[1])||0:Number(i.getParam("height",e))||0,{w:t,h:r}},U=function(e){return new Promise(function(n,t){var i=new XMLHttpRequest;i.open("GET",e),i.withCredentials=!0,i.responseType="blob",i.onload=function(e){200===e.target.status?n(e.target.response):t(e)},i.onerror=function(e){t(e)},i.send()})},k=function(e,n){var t=j(n);return p(c.imageWithSize[0],IDBKeyRange.only([e,t.w,t.h])).then(function(i){var r=i.target.result;return r?Promise.resolve(a(r.blob)):U(n).then(function(n){return g(s.imageList,[{fs_id:e,w:t.w,h:t.h,blob:n}]).then(function(){},function(){}),Promise.resolve(a(n))})})},y=/^blob:/,O={isAvailable:function(){return u.isAvailable&&u.isOpen},getImageURL:function(e,n){return O.isAvailable()?k(e,n):void Promise.reject({})},revokeBlobURL:function(e){y.test(e)&&o(e)}};R(),t.exports=O});
;define("disk-system:widget/system/util/lazyLoadImage.js",function(t,i,e){function s(){function t(){s.isReady=!0,r.isFunction(s.callback)&&s.callback()}if(b||u||!h)return void t();var i=l.getItem(d);return i?(_.HTTPVersion=i,void t()):void n.getJSON("https://thumbnail10.baidupcs.com/httpv").fail(function(){l.setItem(d,"1.1")}).done(function(t){t&&t.version?(l.setItem(d,t.version),_.HTTPVersion=String(t.version)):l.setItem(d,"1.1")}).always(function(){t()})}function o(t){if(t&&!t.src){var i=t.getAttribute("_src");if(i){var e=i.indexOf(I)>-1,s=!e&&i.indexOf(v)>-1;if(!e&&!s)return void(t._src=i);var o=e?I:v,a=I;e&&b&&(a=_.getIdleDomain()),s&&(a=_.getIdleDomain(!0)),o!==a&&(i=i.replace(o,a)),t._src=i}}}function a(){c.call(this),this.images=[],this.fids=[]}var n=t("base:widget/libs/jquerypacket.js"),r=(t("system-core:context/context.js").instanceForSystem,t("disk-system:widget/system/util/imageSystem/imageSystem.js"),t("base:widget/libs/underscore.js")),c=t("base:widget/tools/service/tools.event.js").EventEmitter,m=t("base:widget/tools/service/tools.util.js"),l=t("base:widget/storage/storage.js"),u=!1,d="thumbs_hv",h=!!(XMLHttpRequest&&"withCredentials"in XMLHttpRequest.prototype),g=/thumbnail10\.baidupcs/,p="normal",f="thumbs",b="http:"===document.location.protocol,I="d.pcs.baidu.com",v="thumbnail0.baidupcs",_={HTTPVersion:"1.1",currentDomainIndex:0,domainsList:{normal:[],thumbs:[]},_init:function(){for(var t=this.domainsList,i=0;10>i;i++)t.normal.push("d"+i+".pcs.baidu.com"),t.thumbs.push("thumbnail"+i+".baidupcs")},getIdleDomain:function(t){if(t&&"2"===_.HTTPVersion)return"thumbnail10.baidupcs";var i=t?f:p,e=this.domainsList[i];return e[this.currentDomainIndex++%10]}};_._init(),s.isReady=!1,s(),m.inherits(a,c),a.prototype.changeImages=function(t){if([].push.apply(this.images,t||[]),s.isReady)this._loadImage();else{var i=this;s.callback=function(){i._loadImage()}}},a.prototype._loadImage=function(){if(0!==this.images.length){var t=this.images.shift();o(t),t._src&&(this._installImage(t),this._loadImage())}},a.prototype._installImage=function(t){var i=r.now(),e=this,s=function(t){t.hasError||(t.src=t._src),t.complete?e._loadImageSucc(t):(t.onload=function(){e._loadImageSucc(this,r.now()-i)},t.onerror=function(){t.hasError=!0,e._loadImageFail(this)})};s(t)},a.prototype._loadImageSucc=function(t,i){var e=g.test(t.src);this.emit("done",t,i,e),this._commonLoadImageCall(t,e)},a.prototype._loadImageFail=function(t){this.emit("fail",t),this._commonLoadImageCall(t)},a.prototype._commonLoadImageCall=function(t){t.onload=t.onerror=null,this._loadImage()},e.exports=a});
;define("disk-system:widget/system/fileService/fileMoveCopy/fileMoveCopy.js",function(e,t,a){function r(e,t){for(var a,r,i,o,n="sharedir"===c.getCurrentModule(),u=[],g=!1,m=0;m<e.length;m++)if(a=e[m],r=a.path,i=s.tools.baseService.parseFullDirFromPath(r)||"/",o=1===parseInt(a.isdir,10),g=n&&l.checkIsShareDirByPath(r),g&&(i=("/shareHolder"+i).replace(/\/$/,"")),o&&t!==r&&i!==t&&0!==(t+"/").indexOf(r+"/")||!o&&i!==t)u.push({path:r,dest:t,newname:g?a.server_filename:s.tools.baseService.parseDirFromPath(r)});else if(o)return[];return u}function i(e,t,a,r,i){if(t.length<=0)return s.ui.tip({mode:"caution",msg:"不能将文件"+v[e]+"自身或其子目录下"}),!1;var c=o[e+"Files"];c(t,a,function(t,s,o,c,l){1===t?(n.trigger("quota-change"),r.call(null,e,a,l)):i.call(null,e,a)})}var s=e("system-core:context/context.js").instanceForSystem,o=e("disk-system:widget/system/fileService/asynFileManager/asynFileManager.js"),n=e("system-core:system/baseService/message/message.js"),c=e("base:widget/historyManager/historyManager.js"),l=s.tools.shareDirManager,u=s.libs._,g="",m=e("base:widget/storage/storage.js"),h={"/apps":!0},v={copy:"复制到",move:"移动到"},f=a.exports={showDialog:function(e,t,a,o){var n="move"===t,c="copy"===t;if(n||c){var u="";if(n){var g=e[0].path;l.checkIsShareDirByPath(g)&&(u=l.getRootSharePath(g))}var m=v[t];s.ui.treeDialog({title:m,confirm:function(n){s.ui.treeDialog(!1);var c=f.isNotMoveByPaths(n);if(c)return s.ui.tip({mode:"caution",msg:"无法将文件"+m+"预置文件夹"}),void o(t,n);var l=r(e,n);i(t,l,n,a,o)},showShareDir:c,path:u})}},moveTo:function(e,t,a,s){var o=r(e,t);i("move",o,t,a,s)},isNotMoveByPaths:function(e){return u.isArray(e)||(e=[e]),u.some(e,function(e){var t="";return t=u.isString(e)?e:e.path,h[t]})},manageStatus:function(){var e=!!m.getItem("asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,""));return e?(g&&clearTimeout(g),o.tiping=!0,g=setTimeout(function(){o.tiping=!1},2e3),s.ui.tip({mode:"caution",msg:"当前还有未完成的任务，需完成后才能操作"}),!0):!1},resolveHasTask:o.resolveHasTask}});
;define("disk-system:widget/system/fileService/fileDelete/fileDelete.js",function(e,t,i){function n(e){return!e instanceof Array&&(e=[e]),c.isNotDeleteByPaths(e)}function r(e,t){var i=o.ui.confirm({title:"确认删除",width:"460px",body:t||c.getTip(e),extra:f.getExtra(),onSure:function(){i.hide(),c.doDelete(c.conf.paths,c.conf.callback,c.conf.sync)},onCancel:function(){i.hide()}});i.topShow()}var s=e("disk-system:widget/system/fileService/fileManagerApi/fileManagerApi.js"),a=e("base:widget/historyManager/historyManager.js"),o=e("system-core:context/context.js").instanceForSystem,c={},u=function(e,t,i){c.conf.isInShare="sharedir"===a.getCurrentModule();for(var n,s=[],u=!1,l=!1,f=!1,p=0,d=e.length;d>p;p++){if(n=e[p],c.conf.isInShare)if(n.oper_id&&n.oper_id!==yunData.MYUK){if(!f&&(f=!!n.isdir),!l&&(l=!n.isdir),!n.isdir)continue}else!u&&(u=!0);else 1===n.share&&!u&&(u=!0);s.push(n.path)}c.conf.paths=s,c.conf.callback=t,c.conf.sync=i;var h="",m=c.isNotDeleteByPaths(s);if(m)return h="预置文件不可以删除",o.ui.tip({mode:"caution",msg:h}),void t.call(null,1,h);var y="";if(c.conf.isInShare)if(l){if(!s.length)return void o.ui.alert("此文件为他人创建，只有创建者和目录所属者可删除");y="所选文件中包含他人创建文件，无法删除，<br/>是否只删除自己上传的文件?"}else f&&(y="所选文件中包含他人创建文件，无法删除，<br/>是否只删除自己上传的文件?");!y&&u&&(y="确认删除所选文件吗?<br/>删除后他人将无法查看和管理"),r(s,y)},l={"/apps":!0},c={conf:{},defaultFunc:function(){},getPartFileTipByPath:function(e){var t="",i="你选择的文件包含第三方应用文件，";return e+="/",-1!==e.indexOf("/apps/联通冲印/")?t=i+"删除后将导致联通冲印服务读取数据异常":-1!==e.indexOf("/apps/album/")?t="你选择的文件包含百度相册中的文件，删除后百度相册中的文件也将同步删除":-1!==e.indexOf("/我的分享/")?t="该文件已经分享给你的朋友们了，删除后将无法再被查看":-1!==e.indexOf("/apps/")&&(t=i+"删除后该应用中的文件也将同步被删除"),t},getPartFileTipByPaths:function(e){for(var t="",i=0,n=e.length;n>i&&!(t=c.getPartFileTipByPath(e[i]));i++);return t},getTip:function(e){var t=c.getPartFileTipByPaths(e),i="";return i=t?t+"<br/>是否继续？":"确认要把所选文件放入回收站吗？<br/>",i+f.middleText},isNotDeleteByPaths:function(e){for(var t=!1,i=0,n=e.length;n>i;i++)if(l[e[i]]){t=!0;break}return t},reportUser:function(e){$.getJSON("/api/report/user?action=sapi_auth",function(t){$.isFunction(e)&&e(t)})},doDelete:function(t,i,n){var r=this;s.deleteFiles(t,function(t,n,s){0===t?(o.ui.tip({mode:"success",msg:n}),i.call(null,0,n,s)):132===t?(o.ui.tip({mode:"caution",msg:n}),e.async("base:widget/passAPI/passAPI.js",function(e){e.promiseForceverify.done(function(){e.passAPI.PassportForceInit.netdiskForceVerify(),e.passAPI.PassForceverify.onSubmitFailure=function(){},e.passAPI.PassForceverify.onSubmitSuccess=function(){r.reportUser(function(e){e&&0===e.errno?setTimeout(function(){c.doDelete(c.conf.paths,c.conf.callback,c.conf.sync)},300):o.ui.tip({mode:"caution",msg:"验证失败，请稍后重试！"})})}})})):i.call(null,1,n,s)},n)}},f={middleText:"",extra:"<div class='dialog-extra-body'><button onclick='javascript:window.open(\"/buy/center?tag=8&form=deletefile\",\"_blank\");' class='extra-button' title='立即开通'>立即开通</button><em class='extra-picture'></em>开通超级会员，立享回收站文件30天保存期限</div>",memberStatus:[10,15,30],MemberType:{NOT_MEMBER:0,ORDINARY_MEMBER:1,SUPER_MEMBER:2},isSuperMember:!1,getMemberLevel:function(){return"1"===String(window.yunData.ISSVIP)?this.MemberType.SUPER_MEMBER:window.yunData.ISVIP||0},init:function(){var e=this.getMemberLevel(),t=this.memberStatus[e];this.middleText="删除的文件可在"+t+"天内通过回收站还原",this.isSuperMember=this.getMemberLevel()===this.MemberType.SUPER_MEMBER},getExtra:function(){return this.isSuperMember||c.conf.isInShare?"":this.extra}};f.init(),i.exports={deleteFiles:u,canDelete:n}});
;define("disk-system:widget/system/fileService/createNewDir/createNewDir.js",function(e,t,i){function s(e,t){this.$container=n(e),this.canNotRenameMap={"/apps":!0},this.config=t||{},this.path="",this.parentPath="",this.filename="",this.$newDirDom=this.initDom(),this.$box=this.$newDirDom.find(".GadHyA"),this.bindEvent()}var n=e("base:widget/libs/jquerypacket.js"),o=e("base:widget/tools/tools.js"),a=e("system-core:context/context.js").instanceForSystem,c=e("system-core:system/uiService/tip/tip.js"),r=e("disk-system:widget/system/fileService/fileManagerApi/fileManagerApi.js"),l=e("disk-system:widget/system/util/selection.js");s.prototype.isNotRenameByPaths=function(e){var t=!1;return this.canNotRenameMap[e]&&(t=!0),t},s.prototype.flagExists=function(){return"block"===this.$newDirDom.css("display")},s.prototype.isTypeList=function(){return"block"===this.$container.find(".zJMtAEb").css("display")},s.prototype.focus=function(e){e&&this.$box.val(n.trim(e));var t=n.trim(this.$box.val()),i=t.lastIndexOf(".");0>=i&&(i=t.length),l.setSelectionRange(this.$box[0],0,i)},s.prototype.initDom=function(){var e='<div class="ExFGye"><div class="mjEv3d"><input node-type="gsaoPbG1" class="GadHyA" type="text" value="" /><span node-type="buEWbr" class="kataQBRL"><em class="icon ufuuP7RL">&#xe908;</em><em class="icon zioPNd1">&#xe937;</em></span><span node-type="ynQy3W" class="czctP89j"><em class="icon ufuuP7RL">&#xe908;</em><em class="icon aqhsP5pg">&#xe93a;</em></span></div></div>';return this.$container.append(e),this.$container.find(".ExFGye")},s.prototype.bindEvent=function(){var e=this;this.$newDirDom.delegate("span","click",function(){var t=n(this);return t.hasClass("kataQBRL")?e.sure():t.hasClass("czctP89j")&&e.cancel(),!1}).delegate(".GadHyA","keydown",function(t){13===t.keyCode?e.sure():27===t.keyCode&&e.cancel()})},s.prototype.cancel=function(){"function"==typeof this.config.cancelFunc&&this.config.cancelFunc.call(null),this.hide()},s.prototype.sure=function(){if(this.rename){if(this.filename===n.trim(this.$box.val()))return void this.cancel();this.sendNewDir(this.path,n.trim(this.$box.val()))}else{var e=("/"===this.parentPath?"":this.parentPath)+"/"+n.trim(this.$box.val());this.sendNewDir(e,n.trim(this.$box.val()))}},s.prototype.sendSuccess=function(e,t){"function"==typeof this.config.successFunc&&this.config.successFunc(e,t),this.hide(t)},s.prototype.sendNewDir=function(e,t){var i=this;c.show({mode:"loading",msg:this.rename?"正在重命名，请稍候&hellip;":"正在创建文件夹，请稍候&hellip;",autoClose:!1});var s=this.rename?r.reName:r.createNewDir;s.call(null,e,function(e,s,n){if(1===e)c.show({mode:"caution",msg:s}),i.focus();else{if(2!==n.status&&c.show({mode:"success",msg:s}),i.rename){var a=n.list&&n.list[0]||n.info&&n.info[0],r=(2===n.status?a.from:a.to)||a.path||t;t=o.getFileNameByPath(r)}i.sendSuccess(t,n)}},t)},s.prototype.show=function(e){function t(){"function"==typeof e.complete&&e.complete.call(null),"function"==typeof e.fail&&e.fail.call(null)}function i(t,i){"function"==typeof e.complete&&e.complete.call(null),"function"==typeof e.success&&e.success.call(null,t,i)}this.path=e.path;var s="";return e.rename&&this.isNotRenameByPaths(this.path)?(s="预置文件不可以重命名",c.show({mode:"caution",msg:s}),t(),!1):(this.rename=e.rename,this.parentPath=o.parseFullDirFromPath(this.path),this.filename=o.parseDirFromPath(this.path),this.viewClassName=e.viewClassName,this.$newDirDom.addClass(this.viewClassName),this.config.cancelFunc=t,this.config.successFunc=i,this.cacheMod=e.cacheMod,e.position&&this.$newDirDom.css(e.position),this.rename?("searchGlobal"===this.cacheMod?this.$newDirDom.addClass("vaaxqo74"):this.$newDirDom.removeClass("vaaxqo74"),this.$container.addClass("lhsfQVV3")):this.$container.removeClass("lhsfQVV3"),this.$newDirDom.show(),this.focus(this.filename),!0)},s.prototype.hide=function(e){if(this.viewClassName&&this.$newDirDom.removeClass(this.viewClassName),this.$newDirDom.removeClass("vaaxqo74"),e&&!this.rename){var t=a.getList().cache.getKey(),i=e.path.substring(e.path.lastIndexOf("/")+1),s="-"===e.mtime?e.mtime:o.parseDate(e.mtime),n=a.tools.topMountManager.getLengthByKey(t);this.$newDirDomNode=this.isTypeList()?this.$container.find('dd[_position="'+n+'"]'):this.$container.find('.cEefyz[_position="0"]').eq(n),this.$newDirDomNode.find(".uitPe56").attr("title",i).text(i),this.$newDirDomNode.find(".gshuQABB").text(s),delete this.$newDirDomNode}this.$newDirDom.hide()},i.exports=s});
;define("disk-system:widget/system/util/cache/cacheUtils.js",function(e,t,a){var h=e("system-core:system/cache/listCache/cacheManage.js"),r={getCache:function(){return h.getCache()},deleteCacheByMode:function(e,t,a){var h=t.getDataByKey();this.removeCacheAll();for(var c=h&&h.list,i=!1,o="",s="",n=c.length,v=n-1;v>=0;v--){for(var C=a.length,m=C-1;m>=0;m--)o=a[m],s=o.path||o,c[v].path==s&&(a.splice(m,1),i=!0);i&&(c.splice(v,1),i=!1)}return h.list=c,r.getCache()[t.cacheName].data[t.getKey()]=h,h},removeCacheByPath:function(e){var t=this.getCache(),a={};t&&t.list&&t.list.data&&(a=t.list.data),a[e]&&delete a[e],this.removeOtherListCache()},removeCacheAll:function(){var e=this.getCache();for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].data&&(e[t].data={})},removeCacheByType:function(e,t,a,h){var r=this.getCache(),c={};return r&&r[e]&&r[e].data?(c=r[e].data,this.removeSubFiles(c,t),void("move"===a&&this.removeSubFiles(c,h))):!1},removeCache:function(e,t,a,h){h||(h="list"),this.removeCacheByType(h,e,t,a),"list"===h&&this.removeOtherListCache()},removeSubFiles:function(e,t){t="/"===t?t:t+"/";for(var a in e)e.hasOwnProperty(a)&&0===(a+"/").indexOf(t)&&delete e[a]},removeOtherListCache:function(){this.removeCategoryCache(),this.removeSearchCache(),this.removeTreeCache()},removeCategoryCache:function(){this.removeCacheByKey("category")},removeSearchCache:function(){this.removeCacheByKey("search")},removeTreeCache:function(){this.removeCacheByKey("tree")},removeCacheByKey:function(e){var t=this.getCache();t&&t[e]&&t[e].data&&(t[e].data={})}};a.exports=r});
;define("disk-system:widget/system/util/cache/cacheConfig.js",function(e,t,r){function a(e){var t=!0,r=!1,a="caution",n="",o=i.getList();if(!e||-1!==e.errno&&20!==e.errno){if(e&&e.errno){var s=e.errno,u=i.accountBan(s);if(u.isBan)return o.updateLoadingTips(2,0),o.listEmptyTip(o.$emptyTips),!1;n=i.errorMsg(e.errno,"网络错误，请稍候重试")}}else n='由于您的帐号存在违规行为，帐号已被封禁。<a href="http://help.baidu.com/add?prod_id=48">申诉</a>';i.ui.tip({msg:n,mode:a,autoClose:r,hasClose:t}),o.updateLoadingTips(2,0),o.updateListLoading(3)}var i=e("system-core:context/context.js").instanceForSystem,n={getCacheConfig:function(){var e,t,r=i.getList().onListOrderChange();return r&&(e=r.item,t="number"==typeof r.desc?r.desc:1),{api:"/api/list",params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"list",getParamsBykey:function(e){return{dir:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.dir},topMount:function(e,t,r){return i.tools.topMountManager.mount(e,t,r)},beforeListPush:function(e){for(var t=0;t<e.length;t++)e[t].share=e[t].share?e[t].share%2:0;return i.tools.shareDirManager.diffAll&&(e=i.tools.shareDirManager.diffAll.addDiffMsgToCache(e)),e},failCallBack:function(e,t){a(e,t)}}},getCategoryCacheConfig:function(){var e,t,r=i.getList().onListOrderChange();return r&&(e=r.item,t="number"==typeof r.desc?r.desc:1),{api:"/api/categorylist",params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"info",getParamsBykey:function(e){return{category:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.category},failCallBack:function(e,t){a(e,t)}}},getSearchCacheConfig:function(){return{api:"/api/search",params:{recursion:1,order:"time",desc:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"list",getParamsBykey:function(e){return{key:e}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.key},beforeListPush:function(e){for(var t=0;t<e.length;t++)e[t].share=e[t].share?e[t].share%2:0;return e},failCallBack:function(e,t){a(e,t)}}},getSearchPathCacheConfig:function(){return{api:"/api/filemetas",params:{recursion:1,order:"time",desc:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"info",getParamsBykey:function(e){return{target:$.stringify([e])}},getPageParams:function(e,t){return{page:e+1,num:t}},getKeyByParams:function(e){return e.target},failCallBack:function(e,t){a(e,t)}}},getSearchGlobalCacheConfig:function(){return{api:"/api/textsearch",params:{recursion:1,order:"time",desc:1,showempty:0,web:1},limit:100,currentPage:0,listKey:"list",getParamsBykey:function(e){return{key:e}},getPageParams:function(e,t){return{start:e*t,limit:t}},getKeyByParams:function(e){return e.key},failCallBack:function(e,t){a(e,t)}}},getShareDirCacheConfig:function(){var e,t,r=i.getList().onListOrderChange();return r&&(e=r.item,t="number"==typeof r.desc?r.desc:1),{params:{order:e||"time",desc:void 0!==t?t:1,showempty:0,web:1},forceRequestAPI:"/",limit:100,currentPage:0,listKey:"list",getApi:function(e){return"/"===e.dir?"/sharedir/list?method=receive":"/api/list"},getParamsBykey:function(e){return{dir:e}},getPageParams:function(e,t){return{start:e*t,limit:t}},getKeyByParams:function(e){return e.dir},beforeListPush:function(e,t,r){for(var a=0;a<e.length;a++)e[a].share=1;return i.tools.shareDirManager.diffAll&&(e=i.tools.shareDirManager.diffAll.addDiffMsgToCache(e),"/"===r&&i.tools.shareDirManager.diffAll.checkShareDirRoot()),e},failCallBack:function(e,t){a(e,t)}}}};r.exports=n});
;define("disk-system:widget/pageModule/list/list-view-empty/list-view-empty.js",function(e,o,t){var s=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/hash/hash.js"),d=e("system-core:context/context.js").instanceForSystem,i={dom:{module:".KPDwCE",searchEmptyModule:".vldE2RJ",viewEmptyModule:".pcmzE4oQ",noResultTcode:".ocznQ3XV",noResultTcodePic:'div[node-type~="dvaaQy3a"]',noResultTcodeClose:'a[node-type~="tjuqzoJ"]',newDirBox:'input[node-type~="gsaoPbG1"]',newDir:'div[node-type~="ubykEk4O"]',upLoad:".tuQwoK",swfUpload:".brzjEWb0",iconSpeed:".icon-speed"},bindEvent:function(){var e=s(i.dom.module);e.delegate(i.dom.noResultTcode,"mouseover",function(){s(i.dom.noResultTcodePic).show()}),e.delegate(i.dom.noResultTcode,"mouseout",function(){s(i.dom.noResultTcodePic).hide()})},tmpl:{emptyViewContainer:'<div class="ilbnQAlN pcmzE4oQ" style="" node-type="anQAly"><div node-type="ubykEk4O" class="item global-clearfix" style="display: none;"><div class="fufHyA pdQwKj" style="width: 60%;"><span class="MPbHyA"><span class="soscPe1x"></span></span><span class="hioQyRv jvzyqK6A cdEayN"></span><div class="exuQ3Xv" style="display: block;"><input node-type="gsaoPbG1" class="GadHyA" type="text" value=""><span node-type="buEWbr" class="kataQBRL"></span><span node-type="ynQy3W" class="czctP89j"></span></div></div><div class="fufHyA" style="width: 16%">-</div><div class="fufHyA" style="width: 23%">-</div></div><div class="aGMvFtb"><div class="ilhyE9ME ycqgAQ"><p class="ggEQwFb">您还没上传过文件哦，点击<span class="tuQwoK">上传</span>按钮～</p></div><div class="hywPb23"><div class="oyEk77"><div class="lnotQA7B"></div><span>您还可以下载百度网盘其它客户端</span></div><a hidefocus="true" class="rupmqzog" href="//pan.baidu.com/download#ipad" target="_blank">iPad版下载</a><a hidefocus="true" class="ocznQ3XV" href="//pan.baidu.com/download#android" target="_blank">手机版下载</a><a hidefocus="true" class="nuocqmLJ" href="//pan.baidu.com/download" target="_blank">PC版下载</a></div><div class="vegqKzj" node-type="dvaaQy3a"></div></div></div>',emptySearchContainer:'<div class="vldE2RJ"><div class="rkxPdnX"><div class="kgemEGRb"><i class="sqpwExOp"></i><p>你的网盘中，没有找到相应内容</p></div></div></div>'},util:{render:function(){s(i.tmpl.emptyViewContainer).appendTo(i.dom.module),s(i.tmpl.emptySearchContainer).appendTo(i.dom.module)}},init:function(){i.bindEvent()}};s(document).ready(function(){i.init()});var a={emptyView:function(){setTimeout(function(){d.message.callPlugin("上传@com.baidu.pan",{button:s(".tuQwoK").get(0),mode:"directory",usdDialog:!0}),s(document).on("mouseover",".tuQwoK",function(){s(this).attr({title:""}).css({cursor:"pointer"})}),s(document).on("click",".tuQwoK",function(){s(this).attr("title",""),(s(i.dom.iconSpeed).length>0||s(i.dom.swfUpload).length>0)&&d.ui.tip({mode:"caution",msg:"请点击左上角“上传”按钮"})})},500);var e=n.get("search/key")||n.get("search/vmode")&&n.get("key");return e?i.tmpl.emptySearchContainer:i.tmpl.emptyViewContainer}};t.exports=a});
;define("disk-system:widget/pageModule/list/grid-view/grid-view-builder.js",function(e,t,i){function a(e){C.gridViewContainer||(C.gridViewContainer=e.$gridViewContainer.find(".BNfIyPb")),C.itemHeight||(C.itemHeight=e.getCurrentView().itemHeight);var t=0;if(C.itemHeight>0){var i=C.gridViewContainer.scrollTop();t=Math.max(parseInt(i/C.itemHeight,10)-2,0)}C.load(t)}var s=e("base:widget/libs/underscore.js"),n=e("base:widget/libs/jquerypacket.js"),r=e("base:widget/historyManager/historyManager.js"),l=e("disk-system:widget/system/util/lazyLoadImage.js"),o=e("system-core:system/baseService/message/message.js"),c=e("system-core:context/context.js").instanceForSystem,d={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},m=function(){var e=document.createElement("dd");e.className="g-clearfix";var t=[];t.push('<div class="cEefyz">'),t.push('<div class="aekEOaP" title="">'),t.push('<img class="alaQ1kq"/>'),t.push('<span class="ootqMmq"></span>'),t.push("</div>"),t.push('<div class="file-name">'),t.push('<a node-type="cbqK6b" class="uitPe56" href="javascript:void(0);" title=""></a>'),t.push("</div>"),t.push('<span node-type="EOGexf" class="EOGexf"><span class="icon lgwELbP">&#xe93b;</span><span class="icon checkgridsmall">&#xe935;</span></span>'),t.push("</div>");for(var i=[],a=C.columnsCount=this.getColumnsCount(),s=0;a>s;s++)i.push(t.join(""));return e.innerHTML=i.join(""),e},u=0,h=null,g=null,v=function(){h=null,g=null},p={},f=function(e,t,i){var a,s,l=t;null==l&&(l=this.buildView(e,t,i));for(var m,v=this.getGroupElementsData(),f=v[i],b=n(l),y=this,k="sharedir"===r.getCurrentModule()&&"/"===r.getCurrentParams().path,w=this.getColumnsCount(),I=b.find(".cEefyz"),S=function(e,t){for(var i in t)n.inArray(+i,e)>=0?t[i].addClass("rohEvWq"):t[i].removeClass("rohEvWq")},L=0;L<f.length;L++){m=f[L],a=I[L],s=n(a),a.style.display="block",a.setAttribute("_position",i),p[i*w+L]=s;var A=s.find(".aekEOaP");if(m.disableCheck?s.addClass("mmdqJnq"):s.removeClass("mmdqJnq"),this.isAllItemChecked()||this.isItemChecked(i*w+L)?s.addClass("rohEvWq"):s.removeClass("rohEvWq dscQV9P"),!a.getAttribute("_installed")){var _,x;s.mouseover(function(){if(_=(new Date).getTime(),y.parent.isLocked())return!1;var e=n(this);return e.addClass("dscQV9P"),!1}).mouseout(function(){if(y.parent.isLocked())return!1;var e=n(this);return e.removeClass("dscQV9P"),x=(new Date).getTime(),c.log.send({name:"gridListHover",value:x-_}),!1}),s.bind("click dblclick",function(e){var t=(new Date).getTime();if(y.parent.isLocked())return!1;var i,a=n(this),s=parseInt(a.attr("_position"),10),l=a.index(),m=s*w+l,v=y.getElementsData()[m],f=y.isItemChecked(m),C=!1;if(e.shiftKey){y.setItemsChecked(!1);var b=u,k=m;if(k>b)for(;k>=b;)y.setItemChecked(b,!0),b++;else if(b>k)for(;b>=k;)y.setItemChecked(b,!0),b--;else y.setItemChecked(b,!0);S(y.getCheckedIndexs(),p),h=m}else{if(!e.ctrlKey){if(v.isdir)return y.setItemsChecked(!1),filename=v.server_filename,y.parent.cache.cacheName===d.SEARCH||y.parent.cache.cacheName===d.SEARCHGLOBAL||y.parent.cache.cacheName===d.SEARCHPATH?r.assignUrlHash("list/path="+encodeURIComponent(v.path)+"&vmode="+r.getCurrentParams().vmode):v.externalFun&&"function"==typeof v.externalFun?v.externalFun():"sharedir"===r.getCurrentModule()?y.parent.goHistory("sharedir",v.path):y.parent.addHistory(v.server_filename,v.server_filename),!1;var I=a.data("plugin");if(I&&I.length)return o.trigger("plugin:"+I,{filesList:[v]}),!1;u=m,i=y.getCheckedIndexs(),i.length>0&&(f===!1||f&&i.length>1)&&(y.setItemsChecked(!1),C=!0),f&&i.length>1&&(f=!1)}h=m,g=null,y.setItemChecked(m,!f),C?y.requestLayout():f?a.removeClass("rohEvWq"):a.addClass("rohEvWq")}var L=(new Date).getTime();return c.log.send({name:"gridListSingleSel",value:L-t}),window.getSelection&&window.getSelection().removeAllRanges(),!1}).delegate(".EOGexf","click",function(e){var t=(new Date).getTime();if(y.parent.isLocked())return!1;e.stopPropagation();var i=n(this).closest(".cEefyz");if(i.hasClass("mmdqJnq"))return!1;var a=parseInt(i.attr("_position"),10),s=i.index(),r=a*w+s,l=y.isItemChecked(r);y.setItemChecked(r,!l),u=r,l?i.removeClass("rohEvWq"):(i.addClass("rohEvWq"),c.log.send({name:"listSel",value:1}));var o=(new Date).getTime();c.log.send({name:"gridListMultiSel",value:o-t})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}),a.setAttribute("_installed",1)}var H=m.path;k&&(m.isdir=1,H=m.server_filename);var J=c.file.getIconAndPlugin(H,m.isdir,!1,m.share);s.find(".ootqMmq").remove(),"fileicon-large-video"===J.largeIcon&&(A.append('<span class="ootqMmq"></span>'),s.mouseenter(function(){n(this).find(".ootqMmq").show()}).mouseleave(function(){n(this).find(".ootqMmq").hide()})),A.attr('class', 'aekEOaP '+J.largeIcon),m.isdir||J.plugin?(s.addClass("open-enable"),s.data("plugin",J.plugin)):(s.removeClass("open-enable"),s.data("plugin",""));var T,M,P=s.find(".aekEOaP img");P.removeAttr("src"),4!==m.category&&m.thumbs&&m.thumbs.url1?(M=m.thumbs.url1.replace("size=c140_u90","size=c180_u194"),P.data("fs_id",m.fs_id),(T=C.loadedImgMap[M])?(P.removeAttr("_src").attr("src",T.src).css({left:T.left,top:T.top,visibility:"visible"}),P.parent().attr('class', 'aekEOaP')):P.removeAttr("src").attr("_src",M).css("visibility","hidden")):P.removeAttr("_src").removeAttr("src").css("visibility","hidden"),s.find(".uitPe56").html(J.name).attr("title",J.fileName).data("filename",m.server_name)}if(f.length!=w)for(var j=f.length;w>j;++j)I[j].style.display="none";return l},C={columnsCount:0,gridViewContainer:null,itemHeight:0,lazyLoadImagePlugin:new l,loadedImgMap:{},init:function(){this.lazyLoadImagePlugin.on("done",s.bind(this.imgLoadedSuccessFunc,this)),this.lazyLoadImagePlugin.on("fail",s.bind(this.imgLoadedFailFunc,this))},imgLoadedSuccessFunc:function(e,t,i){e=n(e);var a,s=0,r=0,l=e.width(),o=e.height();l>0&&o>0&&(s=(90-l)/2,r=(92-o)/2),a={left:s,top:r,visibility:"visible"},e.css(a).removeAttr("_src");var d=e.attr("src");if(!d)return!1;var m=d.replace(/http:\/\/d[0-9]\./,"http://d.");a.src=d,this.loadedImgMap[m]=a,e.parent().attr('class', 'aekEOaP'),t&&c.log.send(i?{type:"imgLoading_h2_thumbnail_"+50*Math.ceil(t/50)}:{type:"imgLoading_thumbnail_"+50*Math.ceil(t/50)})},imgLoadedFailFunc:function(e){e=n(e),e.removeAttr("src"),e.removeAttr("_src")},checkCanLoad:function(e){for(var t=0,i=C.gridViewContainer,a=i.scrollTop(),s=i.height();e&&-1===e.className.indexOf("cEefyz");)e=e.parentNode,t+=e.offsetTop;return a-100>t?-1:t>a+s?0:1},load:function(e){for(var t=C.gridViewContainer,i=e?t.find("dd:gt("+e+")").find(".alaQ1kq[_src]"):t.find(".alaQ1kq[_src]"),a=[],s=0,n=i.length;n>s;s++){var r=i[s],l=this.checkCanLoad(r);if(0===l)break;-1!==l?1===l&&([].push.apply(a,[].slice.call(i,s,s+this.columnsCount)),s=s+this.columnsCount-1):s=s+this.columnsCount-1}this.lazyLoadImagePlugin.changeImages(a)}};C.init();var b=-1,y=0,k=1e3;i.exports={getView:f,buildView:m,onScroll:s.debounce(function(){o.trigger("list-view-scroll");var e=this.parent,t=s.now(),i=y;clearTimeout(b),y=t,t-i>k?a(e):b=setTimeout(a,k,e)},350),clear:v}});
;define("disk-system:widget/pageModule/list/list-view/list-view-builder.js",function(e,t,i){function a(){k=null,y=null}function s(){var e=this.parent.listHeader.config.columns||[{width:60},{width:16},{width:23}],t=d.getCurrentModule(),i=document.createElement("dd");return i.className="g-clearfix AuPKyz",i.innerHTML="sharedir"===t?'<span node-type="EOGexf" class="EOGexf"><span class="icon NbKJexb">&#xe937;</span></span><div class="aekEOaP"></div><div class="file-name" style="width:'+e[0].width+'%"><div class="text"><a href="javascript:void(0);" class="uitPe56"></a></div><div class="sybxeNb"></div></div><div class="iihPb53" style="width:'+e[1].width+'%">-</div><div class="abpEkn7" style="width:'+e[2].width+'%"></div><div class="gshuQABB" style="width:'+e[3].width+'%"></div><div class="gfekqr4k" style="width:'+(e[4]?e[4].width-1:0)+'%"><span class="gvwQwGK" node-type="pbqQ6p6"></span></div>':'<span node-type="EOGexf" class="EOGexf"><span class="icon NbKJexb">&#xe937;</span></span><div class="aekEOaP"></div><div class="file-name" style="width:'+e[0].width+'%"><div class="text"><a href="javascript:void(0);" class="uitPe56"></a></div><div class="sybxeNb"></div></div><div class="iihPb53" style="width:'+e[1].width+'%">-</div><div class="gshuQABB" style="width:'+e[2].width+'%"></div><div class="gfekqr4k" style="width:'+(e[3]?e[3].width-1:0)+'%"><span class="gvwQwGK" node-type="pbqQ6p6"></span></div>',i}function n(e){if(e.highlighting&&e.highlighting.abstract){e.highlighting.abstractFixed=e.highlighting.abstract,e.highlighting.abstract=e.highlighting.abstract.replace(/\n+\s*\n/g,"\n"),e.highlighting.abstract=e.highlighting.abstract.replace(C,"");var t=e.highlighting.abstract,i=t.search(/<em>/);i>36&&(t=t.slice(i-12,t.length),e.highlighting.abstractFixed=t),e.highlighting.abstractFixed=e.highlighting.abstractFixed.replace(C,"")}return e}function r(e,t,i){var a=t,s=this;null==a&&(a=this.buildView(e,t,i));var r=this.getElementDataByPosition(i),c=l(a),o=c.find(".aekEOaP"),C=this.parent.cache.cacheName===b.SEARCHGLOBAL,x=("sharedir"===d.getCurrentModule(),"sharedir"===d.getCurrentModule()&&"/"===d.getCurrentParams().path),S=r.path;x&&(r.isdir=1,S=r.server_filename);var A=p.file.getIconAndPlugin(S,r.isdir,!1,r.share),I="-";if(r.show_name)I=g.encodeHTML(r.show_name);else{var _=v.getShowNameByUk(r.oper_id);_&&(I=g.encodeHTML(_))}if(c.find(".abpEkn7").html(I).attr("title",I).data("show_name",I),a.setAttribute("_position",i),a.setAttribute("_cmd_installed",1),r.disableCheck?c.find(".EOGexf").addClass("mmdqJnq"):c.find(".EOGexf").removeClass("mmdqJnq"),this.isAllItemChecked()||this.isItemChecked(i)?c.addClass("rohEvWq"):c.removeClass("rohEvWq dscQV9P"),C){if(r=n(r),c.addClass("eyvzqpYB"),1!==+r.category&&3!==+r.category||!A.plugin)o.removeAttr("style");else{var H=r.thumbs.url1.replace(/size=.*&/,"size=c50_u50&").replace(/&quality=100/,"&quality=80");o.css("background","url("+H+") 50% 50% no-repeat")}o.attr('class', 'aekEOaP '+A.middleIcon)}else o.attr('class', 'aekEOaP '+A.smallIcon);if(r.isdir||A.plugin?(c.addClass("open-enable"),c.data("plugin",A.plugin)):(c.removeClass("open-enable"),c.data("plugin","")),C&&r.highlighting.filename?c.find(".uitPe56").html(r.highlighting.filename).attr("title",A.fileName).data("filename",r.server_filename):c.find(".uitPe56").html(A.name).attr("title",A.name).data("filename",r.server_filename),C){var L=[],D=c.find(".yxtEaxD");L.push(r.highlighting&&r.highlighting.abstract?'<div node-type="ahhPdyo" class="lvsjEWya yxtEaxD" title=" '+r.highlighting.abstract.replace(/\<em\>/g,"").replace(/\<\/em\>/g,"")+'">':'<div node-type="ahhPdyo" class="lvsjEWya yxtEaxD" title="">'),L.push('<span class="pizQ0d5">'),L.push(r.highlighting.abstractFixed?'<span node-type="yzOBbsb" class="yzOBbsb">'+r.highlighting.abstractFixed+"</span>":'<span node-type="yzOBbsb" class="yzOBbsb">'+(r.highlighting.abstract||"")+"</span>"),L.push("</span></div>"),L=L.join(""),0===D.length?c.find(".file-name").append(L):D.html(L)}if(c.find(".iihPb53").text(r.isdir?"-":m.toFriendlyFileSize(r.size)),r.server_mtime||(r.server_mtime="-"),c.find(".gshuQABB").text("-"===r.server_mtime?r.server_mtime:h.parseDate(r.server_mtime)),this.parent.cache.cacheName===b.SEARCH||this.parent.cache.cacheName===b.SEARCHGLOBAL||this.parent.cache.cacheName===b.SEARCHPATH){var E=r.path.split("/"),P="",B="";2===E.length?(P="/",B="全部文件"):(P=E.slice(0,E.length-1).join("/"),B=E[E.length-2]),c.find(".gvwQwGK").data("path",P).attr("title",B).text(B)}if(!a.getAttribute("_installed")){var R,F;c.mouseenter(function(){if(R=(new Date).getTime(),s.parent.isLocked())return!1;var e=l(this);e.addClass("dscQV9P");var t=e.find(".sybxeNb");if(""===t.html()){var i=parseInt(e.attr("_position"),10),a=s.getElementDataByPosition(i);f.resizeButtons([a]),t.html(f.$container.html()),p.addIconFont&&p.message.trigger("addIcon",t[0])}return!1}).mouseleave(function(){if(s.parent.isLocked())return!1;var e=l(this);return e.removeClass("dscQV9P"),e.find(".g-dropdown-button").removeClass("button-open"),F=(new Date).getTime(),p.log.send({name:"listListHover",value:F-R}),!1}),c.click(function(e){if(-1!==s.mCheckedChildren.indexOf(!0)){var t=c.parent().children();t.removeClass("rohEvWq"),s.setItemsChecked(!1)}var i=(new Date).getTime();if(s.parent.isLocked())return!1;if(c.find(".EOGexf").hasClass("mmdqJnq"))return!1;var a=parseInt(this.getAttribute("_position"),10),n=s.isItemChecked(a),r=s.getCheckedIndexs(),o=e.ctrlKey,d=l(this);if(e.shiftKey){var h=Math.min(a,k),m=Math.max(a,k),g=d,u=!1;if("number"==typeof y){var v=Math.min(a,y),f=Math.max(a,y);for(u=v===a;f>=v;)s.setItemChecked(v,!1),g.length>0&&g.removeClass("rohEvWq"),g=u?g.next(w.listViewItem):g.prev(w.listViewItem),v++}for(g=d,u=h===a;m>=h;)s.setItemChecked(h,!0),g.length>0&&g.addClass("rohEvWq"),g=u?g.next(w.listViewItem):g.prev(w.listViewItem),h++;y=a}else y=null,o||(r.length>0&&(n===!1||n&&r.length>1)&&(s.setItemsChecked(!1),d.siblings(w.listViewItem).removeClass("rohEvWq")),n&&r.length>1&&(n=!1)),s.setItemChecked(a,!n),n?d.removeClass("rohEvWq"):d.addClass("rohEvWq"),k=a;var b=(new Date).getTime();p.log.send({name:"listListSingleSel",value:b-i}),window.getSelection&&window.getSelection().removeAllRanges()}),c.delegate(".uitPe56","click",function(){if(s.parent.isLocked())return!1;var e=parseInt(l(this).closest(w.listViewItem)[0].getAttribute("_position"),10),t=s.getElementDataByPosition(e);if(t.isdir)if(s.parent.cache.cacheName===b.SEARCH||s.parent.cache.cacheName===b.SEARCHGLOBAL||s.parent.cache.cacheName===b.SEARCHPATH){var i=d.getCurrentParams().vmode||"",a=i?"&vmode="+i:"";d.getDefault().addHistory("list/path="+encodeURIComponent(t.path)+a)}else t.externalFun&&"function"==typeof t.externalFun?t.externalFun():"sharedir"===d.getCurrentModule()?s.parent.goHistory("sharedir",t.path):s.parent.addHistory(t.server_filename,t.server_filename);else{var n=c.data("plugin");if(!n||!n.length)return!0;u.trigger("plugin:"+n,{filesList:[t]})}return!1}).delegate(".g-button","click",function(){if(s.parent.isLocked())return!1;var e=parseInt(l(this).closest(w.listViewItem)[0].getAttribute("_position"),10),t=s.getElementDataByPosition(e),i=l(this).next(".menu");if(i.length){{i.find(".g-button-menu")}return l(this).closest(".g-dropdown-button").toggleClass("button-open"),void(i.offset().top>l(window).height()-i.outerHeight()?i.addClass("more-list-up"):i.removeClass("more-list-up"))}var a=l(this).index();f.triggerClick(a,{filesList:[t],position:[e]})}).delegate(".g-button-menu","click",function(){if(s.parent.isLocked())return!1;var e=parseInt(l(this).closest(w.listViewItem)[0].getAttribute("_position"),10),t=s.getElementDataByPosition(e),i=l(this).index();f.triggerClick(i,{filesList:[t],position:[e]}),l(this).closest(".g-dropdown-button").removeClass("button-open")}).delegate(".sybxeNb","click",function(e){return s.parent.isLocked()?!1:void e.stopPropagation()}).delegate(".EOGexf","click",function(e){var t=0,i=(new Date).getTime();if(s.parent.isLocked())return!1;if(c.find(".EOGexf").hasClass("mmdqJnq"))return!1;e.stopPropagation();var a=l(this).closest(w.listViewItem),t=parseInt(a.attr("_position"),10),n=s.isItemChecked(t);s.setItemChecked(t,!n),n?a.removeClass("rohEvWq"):(a.addClass("rohEvWq"),p.log.send({name:"listSel",value:1})),t=parseInt(l(this).parent()[0].getAttribute("_position"),10),k=t;var r=(new Date).getTime();p.log.send({name:"listListMultiSel",value:r-i})}).delegate(".EOGexf","dblclick",function(e){e.stopPropagation()}).delegate(".gvwQwGK","click",function(e){e.stopPropagation(),d.getDefault().addHistory("list/path="+encodeURIComponent(l(e.target).data("path"))+"&vmode="+(d.getCurrentParams().vmode||""))}),c.bind("dblclick",function(){if(s.parent.isLocked())return!1;var e=parseInt(l(this)[0].getAttribute("_position"),10),t=s.getElementDataByPosition(e);if(t.isdir)s.parent.cache.cacheName===b.SEARCH||s.parent.cache.cacheName===b.SEARCHGLOBAL||s.parent.cache.cacheName===b.SEARCHPATH?d.assignUrlHash("list/path="+encodeURIComponent(t.path)+"&vmode="+d.getCurrentParams().vmode):t.externalFun&&"function"==typeof t.externalFun?t.externalFun():"sharedir"===d.getCurrentModule()?s.parent.goHistory("sharedir",t.path):s.parent.addHistory(t.server_filename,t.server_filename);else{var i=c.data("plugin");if(!i||!i.length)return!0;u.trigger("plugin:"+i,{filesList:[t]})}return!1}),a.setAttribute("_installed",1)}return a}var l=e("base:widget/libs/jquerypacket.js"),c=e("system-core:data/faceData.js").getData(),o=e("disk-system:widget/system/uiRender/buttonBox/buttonBox.js"),d=e("base:widget/historyManager/historyManager.js"),h=e("base:widget/tools/service/tools.date.js"),m=e("base:widget/tools/service/tools.format.js"),g=e("base:widget/tools/service/tools.html.js"),p=e("system-core:context/context.js").instanceForSystem,u=e("system-core:system/baseService/message/message.js"),v=p.tools.shareDirManager,f=new o({name:"list",limit:2,buttons:c.getButton("list"),container:l("<div>"),containerWidth:219,hideWhenAllButtonDisable:!0,disableFun:{shareDirButtonCheck:v.shareDirButtonCheck}}),b={LIST:"list",CATEGORY:"category",SEARCHPATH:"searchPath",SEARCHGLOBAL:"searchGlobal",SEARCH:"search"},w={listViewItem:".AuPKyz"},C=/^[.,?\]})';:`~!%&*|>，﹐。？、】）·！…’”；：]*/,k=null,y=null;i.exports={getView:r,buildView:s,clear:a,onScroll:function(){u.trigger("list-view-scroll")}}});
;define("disk-system:widget/pageModule/preScanGarbage/preScanGarbage.js",function(e,n,i){var t=e("base:widget/libs/jquerypacket.js"),o=window.yunData||{},a=e("system-core:context/context.js").instanceForSystem,r=e("base:widget/storage/storage.js"),u=e("base:widget/tools/service/tools.format.js"),s={conf:{dialog:null,junkfileDialog:null,someThingShow:!1},url:{garbageTaskQueryUrl:"/api/garbagetaskquery",junkFileTaskQueryUrl:"/api/garbageguid"},util:{getDuplicatePreScan:function(){return s.conf.someThingShow?!1:void t.getJSON(s.url.garbageTaskQueryUrl,{type:"prescan"},function(e){0===e.errno&&e.valid&&s.util.showPreScanDialog(e)})},getJunkFileScan:function(e){var n=e.length?e.length:0;if(!(n>100)){for(var i=[],o=0;n>o;o++){var a={};a.fs_id=e[o].fs_id,a.md5=e[o].md5,a.md5&&a.fs_id&&i.push(a)}t.ajax({url:s.url.junkFileTaskQueryUrl,data:{filelist:t.stringify(i)},type:"POST",success:function(e){0===e.errno&&e.guid&&s.util.showJunkFileDialog()}})}},showGuide:function(){if(9===+o.CURRACTIVITYCODE)return!1;if(s.conf.someThingShow)return!1;if(9===o.CURRACTIVITYCODE)return!1;if(1===o.LOGINSTATUS&&!r.getItem("hide_couponbanner_uk_"+o.MYUK)&&(9===+o.CURRACTIVITYCODE||10===+o.CURRACTIVITYCODE||2===+o.SHOWVIPAD))return!1;var e=Date.parse(new Date),n="preScan_uk_"+o.MYUK,i=r.getItem(n),t=0;if(i){var a=i.indexOf("_");if(a>-1?t=Number(i.substring(i.length-1)):(t=0,i+="_0"),t>=3)return!1}return i?void(i&&e-Number(i.substring(0,i.length-2))>24192e5&&s.util.getDuplicatePreScan()):void s.util.getDuplicatePreScan()},showJunkFileGuide:function(e){if(9===+o.CURRACTIVITYCODE)return!1;if(s.conf.someThingShow)return!1;if(9===+o.CURRACTIVITYCODE)return!1;if(1===o.LOGINSTATUS&&!r.getItem("hide_couponbanner_uk_"+o.MYUK)&&(9===+o.CURRACTIVITYCODE||10===+o.CURRACTIVITYCODE||2===+o.SHOWVIPAD))return!1;if("1"===e.key&&"category"===e.cacheName||"list"===e.cacheName&&"/我的资源"===e.key.substring(0,5)){var n=Date.parse(new Date),i="showJunkVideo_uk_"+o.MYUK,t=r.getItem(i),a=0;if(t){var u=t.indexOf("_");if(u>-1?a=Number(t.substring(t.length-1)):(a=0,t+="_0"),a>=3)return!1}if(!t)return void s.util.getJunkFileScan(e.data);if(t&&n-Number(t.substring(0,t.length-2))>6048e5)return void s.util.getJunkFileScan(e.data)}},showPreScanDialog:function(e){var n=e.info&&e.info.totalSize;if(50>n/1024/1024/1024)return!1;var i=u.toFriendlyFileSize(n);s.conf.dialog||(s.conf.dialog=a.ui.window({id:"pre-scan",title:"",lock:!1,draggable:!1,width:"342px",zIndex:40,noFooter:!0,position:{xy:"bottom-right",offset:{bottom:"10px",right:"10px"},using:{props:{bottom:0},opts:{duration:800}}},body:'<p>您的网盘存有大量重复文件</p><p>清理后可以释放<span class="pre-clear-size">'+i+'</span>空间</p><a href="javascript:void(0);" class="vipbtn">扫描重复文件</a>',onClose:function(){var e=Date.parse(new Date),n="preScan_uk_"+o.MYUK,i=r.getItem(n),t=0;if(i){var u=i.indexOf("_");t=u>-1?Number(i.substring(i.length-1)):0}r.setItem(n,e+"_"+(3===t?3:t+1)),a.log.send({name:"clear_home_guide_duplicate_close",value:"重复文件引导弹窗关闭",sendServerLog:!0})}})),a.log.send({name:"clear_home_guide_duplicate",value:"重复文件引导弹窗",sendServerLog:!0}),s.conf.dialog.show(),s.conf.someThingShow="duplicate"},showJunkFileDialog:function(){s.conf.junkfileDialog||(s.conf.junkfileDialog=a.ui.window({id:"junk-scan",title:"",lock:!1,draggable:!1,width:"342px",zIndex:43,position:{xy:"bottom-right",offset:{bottom:"10px",right:"10px"},using:{props:{bottom:0},opts:{duration:800}}},body:'<p>您的网盘存有大量垃圾视频</p><p>清理后可以释放大量空间</p><a href="javascript:void(0);" class="vipbtn">扫描垃圾视频</a>',onClose:function(){var e=Date.parse(new Date),n="showJunkVideo_uk_"+o.MYUK,i=r.getItem(n),t=0;if(i){var u=i.indexOf("_");t=u>-1?Number(i.substring(i.length-1)):0}r.setItem(n,e+"_"+(3===t?3:t+1)),a.log.send({name:"clear_home_guide_junkFile_close",value:"垃圾文件引导弹窗关闭",sendServerLog:!0})}})),a.log.send({name:"clear_home_guide_junkFile",value:"垃圾文件引导弹窗",sendServerLog:!0}),s.conf.junkfileDialog.show(),s.conf.someThingShow="JunkFile"}},eventInit:function(){t("body").on("click",".dialog-pre-scan .vipbtn",function(){var e=Date.parse(new Date),n="preScan_uk_"+o.MYUK;r.setItem(n,e+"_0"),s.conf.dialog.hide(),a.log.send({name:"clear_home_guide_duplicate_click",value:"重复文件引导弹窗点击",sendServerLog:!0}),window.open("/disk/clear")}),t("body").on("click",".dialog-junk-scan .vipbtn",function(){var e="showJunkVideo_uk_"+o.MYUK,n=Date.parse(new Date);r.setItem(e,n+"_0"),s.conf.junkfileDialog.hide(),a.log.send({name:"clear_home_guide_junkFile_click",value:"垃圾文件引导弹窗点击",sendServerLog:!0}),window.open("/disk/clear")})}},l={duplicateCheck:s.util.showGuide,junkFileShow:s.util.showJunkFileGuide};s.eventInit(),i.exports=l});
;define("disk-system:widget/pageModule/toolbar/sort.js",function(t,e,i){var o=t("base:widget/libs/jquerypacket.js"),s=(t("system-core:context/context.js").instanceForSystem,{conf:{canSort:!0,timer:null},q:{sortSwitchBtn:'div[node-type="suQBAG"]',sortSwitchList:'div[node-type="sDwvAgb"]',sortSwitchItem:'div[node-type="sDwvAgb"] .vAFAFF'},util:{openOrCloseList:function(t){t?o(s.q.sortSwitchList).show():o(s.q.sortSwitchList).hide()},updateOrder:function(e){t.async("disk-system:widget/pageModule/list/listInit.js",function(t){t.updateOrder(e)})},setSortSelect:function(t){var e=-1;t&&"name"===t.item?e=0:t&&"size"===t.item?e=1:t&&"time"===t.item&&(e=2),e>=0&&(o(s.q.sortSwitchItem).removeClass("ugcOHtb"),o(s.q.sortSwitchItem).eq(e).addClass("ugcOHtb"))},setSortAvailable:function(t){t?(s.conf.canSort=!0,o(s.q.sortSwitchBtn).removeClass("fonQyLa")):(s.conf.canSort=!1,o(s.q.sortSwitchBtn).addClass("fonQyLa"))}},bindEvent:function(){o(s.q.sortSwitchBtn).on("mouseenter",function(){return s.conf.canSort!==!0?!1:(clearTimeout(s.conf.timer),void s.util.openOrCloseList(!0))}),o(s.q.sortSwitchBtn).on("mouseleave",function(){s.conf.timer=setTimeout(function(){s.util.openOrCloseList(!1)},300)}),o(s.q.sortSwitchList).on("mouseenter",function(){clearTimeout(s.conf.timer),s.util.openOrCloseList(!0)}),o(s.q.sortSwitchList).on("mouseleave",function(){s.conf.timer=setTimeout(function(){s.util.openOrCloseList(!1)},300)}),o(s.q.sortSwitchItem).on("click",function(){var t=(o(this).index(),o(this).attr("data-key"));s.util.updateOrder(t),s.util.openOrCloseList(!1)})},init:function(){s.bindEvent(),s.util.setSortSelect({item:"time"})}});s.init();var n={setSortSelect:s.util.setSortSelect,setSortAvailable:s.util.setSortAvailable};i.exports=n});
;define("disk-system:widget/system/baseService/shareDir/diffAll/diffAll.js",function(e,t,s){function i(){this.API="/api/diffall?message=2",this.interval=6e4,this.operUpdateMsgList=[],this.dismissMsgList=[],this.shareDirRootChangeList=[],this.firstTriggerShareRootDiff=!1,this.init()}var r=e("base:widget/libs/jquerypacket.js"),a=(e("base:widget/libs/underscore.js"),e("system-core:context/context.js").instanceForSystem),o=e("system-core:system/cache/listCache/cacheManage.js"),n=e("base:widget/historyManager/historyManager.js"),g=e("base:widget/storage/storage.js"),h=window.yunData;i.prototype.init=function(){try{var e=this;e.getStorageMessage(),e.updateCurrentListCache(),e.intervalQuery(),e.getData().then(function(){var t=n.getCurrentModule(),s=n.getCurrentParams().path;"sharedir"===t&&"/"===s&&(e.firstTriggerShareRootDiff=!0,a.message.trigger("after-share-dir-root-diffall",e.shareDirRootChangeList))}),a.message.once("after-share-dir-root-guide",function(){e.firstTriggerShareRootDiff&&a.message.trigger("after-share-dir-root-diffall",e.shareDirRootChangeList)})}catch(t){throw new Error("start share dir diffall service error")}},i.prototype.getData=function(){var e=this,t=new r.Deferred;return r.ajax({url:e.API,method:"GET"}).done(function(s){if(0===+s.errno&&s.sf.list.length>0){for(var i=s.sf.list,r=!1,a=0;a<i.length;a++)if(4===+i[a].status){r=!0;for(var o=!1,n=0;n<e.operUpdateMsgList.length;n++)if(e.operUpdateMsgList[n].fid===i[a].fid){o=!0;break}o||e.operUpdateMsgList.push(i[a])}else if(5===+i[a].status){r=!0;for(var o=!1,n=0;n<e.dismissMsgList.length;n++)if(e.dismissMsgList[n].fid===i[a].fid){o=!0;break}o||e.dismissMsgList.push(i[a])}else if((1===+i[a].status||2===+i[a].status)&&0===+i[a].is_owner){r=!0;for(var n=0;n<e.shareDirRootChangeList.length;n++)if(e.shareDirRootChangeList[n].fid===i[a].fid){o=!0;break}o||e.shareDirRootChangeList.push(i[a])}r&&(e.updateStorageMessage(),e.updateCurrentListCache())}t.resolve()}),t},i.prototype.intervalQuery=function(){var e,t,s=this,i=setInterval(function(){s.getData()},s.interval);"undefined"!=typeof document.hidden?(e="visibilitychange",t="visibilityState"):"undefined"!=typeof document.mozHidden?(e="mozvisibilitychange",t="mozVisibilityState"):"undefined"!=typeof document.msHidden?(e="msvisibilitychange",t="msVisibilityState"):"undefined"!=typeof document.webkitHidden&&(e="webkitvisibilitychange",t="webkitVisibilityState"),e&&t&&document.addEventListener(e,function(){"visible"===document[t]?(clearInterval(i),s.getData(),i=setInterval(function(){s.getData()},s.interval)):clearInterval(i)})},i.prototype.getStorageMessage=function(){var e=this,t=g.getItem("shareDirDiffMsg_"+h.MYUK)||"",s=r.parseJSON(t)||{};s.operUpdateMsgList?e.operUpdateMsgList=s.operUpdateMsgList:null,s.dismissMsgList?e.dismissMsgList=s.dismissMsgList:null,s.shareDirRootChangeList?e.shareDirRootChangeList=s.shareDirRootChangeList:null},i.prototype.updateStorageMessage=function(){var e=this,t={operUpdateMsgList:e.operUpdateMsgList,dismissMsgList:e.dismissMsgList,shareDirRootChangeList:e.shareDirRootChangeList};g.setItem("shareDirDiffMsg_"+h.MYUK,r.stringify(t))},i.prototype.updateCurrentListCache=function(){for(var e=this,t=n.getCurrentModule(),s=n.getCurrentParams().path,i=a.list.getCurrentList(),r=0;r<e.operUpdateMsgList.length;r++)for(var g=e.operUpdateMsgList[r],h=0;h<i.length;h++){var d=i[h];d.path!==g.path||d.new_sharedir_detail||(d.new_sharedir_detail=1,o.replaceSingleCache(t,s,d,h))}for(var r=0;r<e.dismissMsgList.length;r++)for(var f=e.dismissMsgList[r],h=0;h<i.length;h++){var d=i[h];d.path===f.path&&1===+d.share&&(d.share=0,o.replaceSingleCache(t,s,d,h),a.list.refresh(),a.message.trigger("system-update-list-operate"))}},i.prototype.addDiffMsgToCache=function(e){for(var t=this,s=0;s<t.operUpdateMsgList.length;s++)for(var i=0;i<e.length;i++)if(t.operUpdateMsgList[s].path===e[i].path){e[i].new_sharedir_detail=1;break}for(var s=0;s<t.dismissMsgList.length;s++)for(var i=0;i<e.length;i++)if(t.dismissMsgList[s].path===e[i].path&&1===+e[i].share){e[i].share=0;break}return e},i.prototype.checkShareDirRoot=function(){var e=this;e.getData().then(function(){a.message.trigger("after-share-dir-root-diffall",e.shareDirRootChangeList)})},i.prototype.removeDiffMsg=function(e,t){var s=this;if("operUpdate"===e)for(var i=0;i<s.operUpdateMsgList.length;i++){var r=s.operUpdateMsgList[i];if(r.path===t){var a=o.getCache(),n=t.match(/<share>/)?"sharedir":"list",g=t.substr(0,t.lastIndexOf("/"))||"/",h=a[n]&&a[n].data&&a[n].data[g]||{};if(h.list&&h.list.length>0)for(var d=0;d<h.list.length;d++)if(h.list[d].path===t){delete h.list[d].new_sharedir_detail,o.replaceSingleCache(n,g,h.list[d],d);break}s.operUpdateMsgList.splice(i,1),s.updateStorageMessage();break}}else if("dismiss"===e)for(var i=0;i<s.dismissMsgList.length;i++){var f=s.dismissMsgList[i];if(f.path===t){s.dismissMsgList.splice(i,1),s.updateStorageMessage();break}}else"shareDirRoot"===e&&(s.shareDirRootChangeList=[],s.updateStorageMessage())},s.exports=i});
;define("disk-system:widget/system/baseService/payFactory/service/payBase.js",function(t,e,o){function i(){}i.prototype.toPay=function(){this.$form&&$("#"+this.formId).submit()},i.prototype.buildForm=function(){throw new Error('The method "buildForm" must be inherited !')},i.prototype.setFormItem=function(t,e){this.$form&&this.$form.find('input[name="'+t+'"]').val(e)},o.exports=i});
;define("disk-system:widget/system/baseService/payFactory/service/payUtil.js",function(t,e,n){var s=t("system-core:context/context.js").instanceForSystem;n.exports={creatBid:function(){return(new Date).getTime()+""+Math.round(9999*Math.random())},timeFormat:function(t,e){var n=new Date(1e3*parseFloat(t)),s=n.getMonth()+1,i=n.getDate(),a=n.getHours(),o=n.getMinutes(),r=n.getSeconds();return+e?n.getFullYear()+"-"+(String(s).length<2?"0"+s:s)+"-"+(String(i).length<2?"0"+i:i)+" "+(String(a).length<2?"0"+a:a)+":"+(String(o).length<2?"0"+o:o)+":"+(String(r).length<2?"0"+r:r):n.getFullYear()+"-"+(String(s).length<2?"0"+s:s)+"-"+(String(i).length<2?"0"+i:i)},toLogin:function(){var e=s.ui.tip({mode:"loading",msg:"请稍候..."});t.async("base:widget/passAPI/passAPI.js",function(t){e.hideTip(),t.promise.done(function(){t.passAPI.PassportInit.netdiskLogin({reload:!0}),t.passAPI.PassLoginDialog.onLoginSuccessCallback=function(){t.passAPI.PassportInit.hide()}})})}}});
;define("disk-system:widget/system/baseService/payFactory/service/payActivity.js",function(t,e,s){function i(){}var o=t("base:widget/libs/jquerypacket.js"),r=t("disk-system:widget/system/baseService/payFactory/service/payBase.js"),n=t("system-core:context/context.js").instanceForSystem;i.prototype=new r,i.prototype.constructor=i,o.extend(i.prototype,{rePay:function(){if(!this.$form)throw new Error("The $form is must !")},buildForm:function(){var t=['<form target="'+i.ACTION_MODE+'" method="get" action="'+i.API_ACTION_PAY+'" id="'+this.formId+'" style="display:none;">','<input name="method"/>','<input name="product_name"/>','<input name="start"/>','<input name="business_no"/>','<input name="buy_way"/>','<input name="sign"/>','<input name="dqStatCode"/>',"</form>"];this.$form=o(t.join(""))}}),o.extend(i.prototype,{init:function(){this.buildForm(),this.setFormItemsFromConfig(),this.setFormItems()},setFormItems:function(){this.setFormItem("method","purchase"),this.setFormItem("business_no",payUtil.creatBid()),this.setFormItem("sign",""),this.setFormItem("product_name",this.productName),this.setFormItem("start",this.vipStartTime),this.setFormItem("buy_way",this.isVip?1:0),this.setFormItem("dqStatCode",this.dqStateCode?this.dqStateCode:"")},setFormItemsFromConfig:function(){if(this.addFormItems)for(var t in this.addFormItems)this.$form.append('<input name="'+t+'" value="'+this.addFormItems[t]+'" />')},fetchUserInfo:function(t){this.ajaxUserInfo(t)},ajaxUserInfo:function(t){var e=this;o.ajax({url:"/rest/2.0/membership/user?method=query",type:"GET",timeout:1e4,cache:!1,async:!1,dataType:"JSON",success:function(s){e.doVipDuration(s.product_infos,t)},error:function(){n.ui.tip({mode:"loading",msg:"网络错误，请稍候重试",autoClose:!1,hasClose:!1})}})},doVipDuration:function(t,e){for(var s,i=[],o=t,r=0;r<o.length;r++)s=o[r],/vip1/gi.test(s.product_name)&&i.push(s);if(0!=i.length)var n=parseFloat(i[0].start_time),a=parseFloat(i[0].end_time);for(var m=0;m<i.length;m++)n=parseFloat(i[m].start_time)>n?n:parseFloat(i[m].start_time),a=parseFloat(i[m].end_time)<a?a:parseFloat(i[m].end_time);e&&"function"==typeof e&&e({currentVipStartTime:n,currentVipEndTime:a})}}),s.exports=i});
;define("disk-system:widget/system/baseService/payFactory/service/payCapacity.js",function(t,e,i){function r(t){this.$form=null,this.serverTime=t.serverTime,this.isVip=t.isVip,this.quotaStartTime=t.quotaStartTime,this.formId=t.formId||r.DEFAULT_FORM_ID,this.productId=t.productId||r.DEFAULT_PRODUCT_ID,this.buyWay=t.buyWay||r.MODE_BUY_WAY_DEFAULT,this.dqStateCode=t.dqStateCode?t.dqStateCode:"",this.init()}var o=t("base:widget/libs/jquerypacket.js"),s=t("disk-system:widget/system/baseService/payFactory/service/payBase.js"),n=t("disk-system:widget/system/baseService/payFactory/service/payUtil.js"),a=t("system-core:context/context.js").instanceForSystem;r.API_ACTION_PAY="/rest/2.0/membership/product",r.ACTION_MODE="_target",r.DEFAULT_FORM_ID="payQuotaForm",r.MODE_BUY_WAY_RENEW=1,r.MODE_BUY_WAY_COMPOSITION=2,r.MODE_BUY_WAY_DEFAULT=r.MODE_BUY_WAY_RENEW,r.PACKAGE_LIST=[{product_name:"15GB",product_id:"4880050357179372399"},{product_name:"30GB",product_id:"13566730592746897967"},{product_name:"50GB",product_id:"1669981989677457522"},{product_name:"100GB",product_id:"17280046393110397375"}],r.DEFAULT_PRODUCT_ID=r.PACKAGE_LIST[2].product_id,r.prototype=new s,r.prototype.constructor=r,o.extend(r.prototype,{rePay:function(){if(!this.$form)throw new Error("The $form is must !")},buildForm:function(){var t=['<form target="'+r.ACTION_MODE+'" method="get" action="'+r.API_ACTION_PAY+'" id="'+this.formId+'" style="display:none;">','<input name="method">','<input name="business_no">','<input name="sign">','<input name="product_id">','<input name="start">','<input name="buy_way">','<input name="dqStatCode">','<input name="pay_way">','<input name="vcode_str">',"</form>"];this.$form=o(t.join("")),o("body").append(this.$form)}}),o.extend(r.prototype,{init:function(){o("#"+this.formId).remove(),this.buildForm(),this.setFormItems()},setFormItems:function(){this.setFormItem("method","purchase"),this.setFormItem("business_no",n.creatBid()),this.setFormItem("sign",""),this.setFormItem("product_id",this.productId),this.setFormItem("start",this.quotaStartTime),this.setFormItem("buy_way",this.buyWay),this.setFormItem("dqStatCode",this.dqStateCode)},ajaxCurrenUserQouta:function(){var t=this;o.ajax({url:"/api/quota",type:"GET",timeout:1e4,cache:!0,async:!1,dataType:"JSON",success:function(e){t.checkUserProduct(e)},error:function(){a.ui.tip({mode:"caution",msg:"网络错误，请稍候重试"})}})},checkUserProduct:function(){var t=function(t){for(var e,i=0,r=0,o=t.length;o>r;r++)e=t[r],e.end_time>i&&(i=e.end_time);return i};return function(e,i){for(var o=e.product_infos,s=[],n=0;n<r.PACKAGE_LIST.length;n++)for(var a=r.PACKAGE_LIST[n].product_id,d=0;d<o.length;d++)e.currenttime>o[d].end_time||a==o[d].product_id&&s.push(e.product_infos[d]);var u=t(s);i&&"function"==typeof i&&i({currentQuotaStartTime:u})}}()}),i.exports=r});
;define("disk-system:widget/system/baseService/payFactory/service/payVip.js",function(t,e,i){function s(t){this.$form=null,this.serverTime=t.serverTime,this.isVip=t.isVip,this.dqStateCode=t.dqStateCode?t.dqStateCode:"",this.vipStartTime=t.vipStartTime,this.addFormItems=t.addFormItems,this.formId=t.formId||s.DEFAULT_FORM_ID,this.productName=t.productName||s.DEFAULT_PRODUCT_NAME,this.init()}var r=t("base:widget/libs/jquerypacket.js"),o=t("disk-system:widget/system/baseService/payFactory/service/payBase.js"),m=t("disk-system:widget/system/baseService/payFactory/service/payUtil.js"),a=t("system-core:context/context.js");s.LOG_CODE_IS_VIP="99_109_139",s.LOG_CODE_IS_NO_VIP="99_100_138",s.API_ACTION_PAY="/rest/2.0/membership/product",s.ACTION_MODE="_target",s.DEFAULT_FORM_ID="payVipForm",s.PACKAGE_LIST=[{product_name:"vip1_1m",product_id:"13216777582222349574"},{product_name:"vip1_3m",product_id:"7322772448495138379"},{product_name:"vip1_6m",product_id:"7349836666708701604"},{product_name:"vip1_1y",product_id:"145433372644027012"}],s.DEFAULT_PRODUCT_NAME=s.PACKAGE_LIST[2].product_name,s.prototype=new o,s.prototype.constructor=s,r.extend(s.prototype,{rePay:function(){if(!this.$form)throw new Error("The $form is must !")},buildForm:function(){var t=['<form target="'+s.ACTION_MODE+'" method="get" action="'+s.API_ACTION_PAY+'" id="'+this.formId+'" style="display:none;">','<input name="method"/>','<input name="product_name"/>','<input name="start"/>','<input name="business_no"/>','<input name="buy_way"/>','<input name="sign"/>','<input name="dqStatCode"/>',"</form>"];this.$form=r(t.join("")),r("body").append(this.$form)}}),r.extend(s.prototype,{init:function(){r("#"+this.formId).remove(),this.buildForm(),this.setFormItemsFromConfig(),this.setFormItems()},setFormItems:function(){this.setFormItem("method","purchase"),this.setFormItem("business_no",m.creatBid()),this.setFormItem("sign",""),this.setFormItem("product_name",this.productName),this.setFormItem("start",this.vipStartTime),this.setFormItem("buy_way",this.isVip?1:0),this.setFormItem("dqStatCode",this.dqStateCode?this.dqStateCode:"")},setFormItemsFromConfig:function(){if(this.addFormItems)for(var t in this.addFormItems)this.$form.append('<input name="'+t+'" value="'+this.addFormItems[t]+'" />')},fetchUserInfo:function(t){this.ajaxUserInfo(t)},ajaxUserInfo:function(t){var e=this;r.ajax({url:"/rest/2.0/membership/user?method=query",type:"GET",timeout:1e4,cache:!1,async:!1,dataType:"JSON",success:function(i){e.doVipDuration(i.product_infos,t)},error:function(){a.instanceForSystem.ui.tip({mode:"caution",msg:"网络错误，请稍候重试"})}})},doVipDuration:function(t,e){for(var i,s=[],r=t,o=0;o<r.length;o++)i=r[o],/vip1/gi.test(i.product_name)&&s.push(i);if(0!=s.length)var m=parseFloat(s[0].start_time),a=parseFloat(s[0].end_time);for(var n=0;n<s.length;n++)m=parseFloat(s[n].start_time)>m?m:parseFloat(s[n].start_time),a=parseFloat(s[n].end_time)<a?a:parseFloat(s[n].end_time);e&&"function"==typeof e&&e({currentVipStartTime:m,currentVipEndTime:a})}}),i.exports=s});
;define("disk-system:widget/system/baseService/topMountManager.js",function(t,e,r){function n(){this.conf=[],this.conf.push({isdir:1,server_filename:"我的卡包",path:u,disableCheck:!0,mountPath:"/",mountView:["list","grid"],externalFun:function(){i.log.send({type:"cardHolder_enter_click",value:"",sendServerLog:!0}),o.callPlugin("网盘二级密码@com.baidu.pan",{successCb:function(){var t=a.getCurrentParams().vmode||"",e=t?"&vmode="+t:"";a.getDefault().addHistory("cardholder/path="+encodeURIComponent("/cardholder")+e)}})}}),1===d.sharedir&&this.conf.push({isdir:1,dir_empty:1-Number(d.sharedir),server_filename:"共享给我的文件夹",icon:f,path:c,disableCheck:!0,share:1,mountPath:"/",mountView:["list","grid"],externalFun:function(){var t=a.getCurrentParams().vmode||"",e=t?"&vmode="+t:"";a.getDefault().addHistory("sharedir/path="+encodeURIComponent("/")+e)}})}var a=t("base:widget/historyManager/historyManager.js"),o=t("system-core:system/baseService/message/message.js"),i=t("system-core:context/context.js").instanceForSystem,s=t("base:widget/libs/underscore.js"),d=window.yunData,u="cardHolder",c="shareHolder",f="dir-share-small";n.prototype.FILE_IDENTITY={CARD:u,SHARE:c},n.prototype.SHARE_DIR_ICON=f,n.prototype.mount=function(t,e,r,n){if(e&&e.data){var a=this.conf;n&&(n=n.toString(),a=s.filter(a,function(t){return n.indexOf(t.path)>-1}));for(var o=a.length-1;o>=0;o--){var i=a[o],d=i.mountPath;if(e.data[d]){var u=e.data[d].list;u&&u.indexOf(i)<0&&u.unshift(i)}}return e.data[r].list}},n.prototype.demount=function(t,e,r,n){if(e&&e.data){var a=this.conf;n&&(n=n.toString(),a=s.filter(a,function(t){return n.indexOf(t.path)>-1}));for(var o=a.length-1;o>=0;o--){var i=a[o],d=i.mountPath;if(e.data[d]){var u=e.data[d].list;e.data[d].list=s.filter(u,function(t){return t!==i})}}return e.data[r].list}},n.prototype.removeConfByPath=function(t){var e=this;e.conf=s.filter(e.conf,function(e){return e.path!==t})},n.prototype.getLengthByKey=function(t){for(var e=0,r=this.conf.length-1;r>=0;r--){var n=this.conf[r],a=n.mountPath;t===a&&e++}return e},r.exports=new n});
;define("disk-system:widget/system/baseService/shareDir/shareDirManager.js",function(e,t,a){function r(){this.currentDirEntity=null,this.memberListCache={},this.listFetching=!1,this.fetchCallback=[],this.diffAll=null,this.diffAllInitCnt=0}var i=e("base:widget/libs/jquerypacket.js"),s=e("base:widget/libs/underscore.js"),n=e("base:widget/tools/tools.js"),o=e("base:widget/historyManager/historyManager.js"),h=e("system-core:context/context.js").instanceForSystem,l=e("system-core:system/cache/listCache/cacheManage.js"),f=e("disk-system:widget/system/baseService/shareDir/diffAll/diffAll.js"),c=window.yunData,d=/^(\/<share>\d+-\d+)\/?/,u=n.client();r.prototype.initDiffAll=function(){0===this.diffAllInitCnt&&(this.diffAllInitCnt++,this.diffAll=new f)},r.prototype.getFakepathInfo=function(e){var t=/^(\/)?(<share>(\d+)-(\d+))(\/)?(.*)$/gi,a=t.exec(e),r=!1;return a&&(r={fakeRootPath:a[2],uk:a[3]?parseInt(a[3],10):0,fid:a[4]?parseInt(a[4],10):0,subPath:a[6]}),r},r.prototype.getNameByFakepath=function(e,t){var a=this,r=l.getCache().sharedir,s=r.data["/"];if(a.listFetching)return void a.fetchCallback.push(t);if(s){var n,o=s.list,f=this.getFakepathInfo(e);if(f)for(var c=f.uk,d=f.fid,u=0;u<o.length;u++)if(o[u].uk===c&&o[u].fid===d){n=o[u].server_filename;break}t(n)}else a.listFetching=!0,a.fetchCallback.push(t),i.ajax({url:"/sharedir/list?method=receive",data:{start:0,limit:100}}).done(function(t){if(a.listFetching=!1,t&&0===t.errno)for(r.data["/"]={list:t.list,hasMore:!1};a.fetchCallback.length;)a.getNameByFakepath(e,a.fetchCallback.shift());else{{h.ui.tip({mode:"failure",msg:h.errorMsg(t.errno,"共享目录列表加载失败")})}location.href="//pan.baidu.com/disk/home#list/path=%2F&vmode=list"}}).fail(function(e){a.listFetching=!1;h.ui.tip({mode:"failure",msg:h.errorMsg(e.errno,"共享目录列表加载失败")});location.href="//pan.baidu.com/disk/home#list/path=%2F&vmode=list"})},r.prototype.disableButtonConfig={upload:{path:"!=/"},newdir:{path:"!=/"},share:{force:!0},download:{},"delete":{path:"!=/",operId:c.MYUK},rename:{path:"!=/",operId:c.MYUK},copy:{},cut:{path:"!=/",operId:c.MYUK},myDevice:{force:!0}},r.prototype.shareDirButtonCheck=function(e,t,a){var i=!1,n="menu"===a?e.name:e.config.name,h="menu"===a?e.title:e.config.title,l=o.getCurrentModule(),f=r.prototype.disableButtonConfig[n||h]||{},c=s.chain(t).pluck("oper_id").without(f.operId).value();if("sharedir"===l&&f){var d=o.getCurrentParams().path;f.path&&(0===f.path.indexOf("!=")&&f.path.substr(2)===d||0===f.path.indexOf("=")&&f.path.substr(1)!==d)&&(i=!0),f.operId&&c.length>0&&(i=!0),f.force&&(i=!0),"upload"===n&&u.browser.ie&&u.browser.ie<=10&&(e.config.disabled=i?"none":"disabled")}return i},r.prototype.getMemberList=function(e,t){var a=this.memberListCache[e],r=this;if(a)t&&t(a);else{var s=/^<share>(\d+)-(\d+)/gi.exec(e);if(s){var n=parseInt(s[1],10),o=parseInt(s[2],10);i.ajax({url:"/sharedir/member/list",data:{uk:n,fid:o,start:0,limit:50},success:function(a){a&&0===a.errno?(r.memberListCache[e]=a.list,t&&t(r.memberListCache[e])):t&&t(!1)},error:function(){t&&t(!1)}})}}},r.prototype.getMemberByUk=function(e,t){var a=this.memberListCache[e],r=!1;if(a)for(var i=0;i<a.length;i++)if(a[i]&&a[i].uk&&a[i].uk===t){r=a[i];break}return r},r.prototype.getShowNameByUk=function(e){var t=l.getCache().sharedir,a=o.getCurrentParams().path,r="-";if(t&&t.data&&t.data[a]&&t.data[a].names){var i=t.data[a].names;if(0===e){var s=/\d+(?=-\d+$)/;if(s.test(a)){var n=a.match(s)[0];i[n]?r=i[n]:null}}else i[e]?r=i[e]:null}return r},r.prototype.getCurrentShareMeta=function(e){var t=!1,a=this.getFakepathInfo(e?e:o.getCurrentParams().path);return a&&(t={key:a.fakeRootPath,uk:a.uk,fid:a.fid}),t},r.prototype.checkIsShareDirByPath=function(e){return e&&"string"==typeof e?"shareHolder"===e?!0:d.test(e):!1},r.prototype.getRootSharePath=function(e){var t=e.match(d);return t&&t[1]?t[1]:""},a.exports=new r});
;define("disk-system:widget/system/baseService/payFactory/payFactory.js",function(e,s,i){var t=e("disk-system:widget/system/baseService/payFactory/service/payVip.js"),r=e("disk-system:widget/system/baseService/payFactory/service/payCapacity.js"),o=e("disk-system:widget/system/baseService/payFactory/service/payActivity.js"),a=e("disk-system:widget/system/baseService/payFactory/service/payUtil.js"),y={Mode_Vip:1,Mode_Quota:2,Mode_Activity:3};y.createPayService=function(e){if(e.isLogin===!1)return void a.toLogin();switch(e.mode){case y.Mode_Vip:if(void 0===e.isVip)throw new Error("The isVip of config is must !");if(!e.serverTime)throw new Error("The serverTime of config is must !");return new t(e);case y.Mode_Quota:return new r(e);case y.Mode_Activity:return new o(e);default:throw new Error("The mode of pay is empty ! Please check the mode !")}},i.exports=y});
;define("disk-system:widget/system/fileService/fileOperate/fileOperate.js",function(a,e,l){var r=a("base:widget/tools/tools.js"),d=a("base:widget/historyManager/historyManager.js"),i=a("system-core:data/faceData.js"),m=a("system-core:data/regedit.js"),n=i.getData().fileIcon;l.exports.getInfo=function(a,e,l,i,s){a=a||"";var o=a.substring(a.lastIndexOf("/")+1),t={fileName:o,name:r.toEntity(o)};if(i)return t.smallIcon="dir-multi-small",t.middleIcon="dir-multi-middle",t.largeIcon="dir-multi-large",t;if(e)return a.match(/^\/apps$/)?(t.smallIcon="dir-apps-small",t.largeIcon="dir-apps-large",t.middleIcon="dir-apps-middle",t.name="我的应用数据",t):a.match(/^\/百度云收藏$/)?(t.smallIcon="dir-cang-small",t.largeIcon="dir-cang-large",t.middleIcon="dir-cang-middle",t.name="我的收藏",t):a.match(/^\/来自PC的备份文件$/)?(t.smallIcon="dir-backup-small",t.largeIcon="dir-backup-large",t.middleIcon="dir-backup-middle",t):a.match(/^\/apps\//)||a.match(/^\/百度云收藏\//)||a.match(/^\/来自PC的备份文件\//)?(t.smallIcon="dir-app-small",t.largeIcon="dir-app-large",t.middleIcon="dir-app-middle",t):a.match(/^cardHolder/)?(t.smallIcon="dir-card-small",t.largeIcon="dir-card-large",t.middleIcon="dir-card-middle",t.name="我的卡包",t):a.match(/^shareHolder/)?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t.name="共享给我的文件夹",t):255!==window.yunData.sharedir&&s?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t):"sharedir"===d.getCurrentModule()?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t):(t.smallIcon="dir-small",t.largeIcon="dir-large",t.middleIcon="dir-middle",t);t.largeIcon="default-large",t.smallIcon="default-small",t.middleIcon="default-middle";var c=-1!==a.lastIndexOf(".")?r.getFileCategory(a):"*";n[c]&&(3===n[c].length?(t.smallIcon=n[c][0],t.largeIcon=n[c][1],t.middleIcon=n[c][2]):2===n[c].length?(t.smallIcon=n[c][0],t.largeIcon=n[c][1]):(t.smallIcon=n[c],t.largeIcon=n[c]));var g=m.getDefaultPluginIdByExtension(c);return!l&&g&&(g=m.getPluginById(g).name+"@"+m.getOtherInfoById(g).group),t.plugin=g,t};var s=["dir","multi","shouchang","yingyong","yingyong_child","beifen","doc","docx","xls","xlsx","ppt","pptx","pdf","txt","jpg","jpeg","gif","bmp","png","jpe","cur","svg","svgz","tif","tiff","ico","wma","wav","mp3","aac","ra","ram","mp2","ogg","aif","mpega","amr","mid","midi","m4a","wmv","rmvb","mpeg4","mpeg2","flv","avi","3gp","mpga","qt","rm","wmz","wmd","wvx","wmx","wm","swf","mpg","mp4","mkv","mpeg","mov","asf","zip","rar","torrent"];l.exports.isOpenedFile=function(a,e){return e&&"torrent"===a?!1:s.indexOf(a)>=0}});
;define("disk-system:widget/system/uiRender/menu/menu.js",function(e){e("disk-system:widget/system/uiRender/menu/listMenu/listMenu.js"),e("disk-system:widget/system/uiRender/menu/contextMenu/contextMenu.js")});
;define("disk-system:widget/pageModule/list/listInit.js",function(e,t,i){var a=e("base:widget/tools/tools.js"),r=e("base:widget/storage/storage.js"),n=e("base:widget/libs/jquerypacket.js"),s=e("base:widget/historyManager/historyManager.js"),o=e("system-core:context/context.js"),c=e("system-core:system/cache/listCache/cacheManage.js"),l=o.instanceForSystem,d=l.message,h=e("disk-system:widget/pageModule/preScanGarbage/preScanGarbage.js"),u=e("disk-system:widget/pageModule/list/list-view/list-view-builder.js"),g=e("disk-system:widget/pageModule/list/grid-view/grid-view-builder.js"),m=e("disk-system:widget/pageModule/list/list-view-empty/list-view-empty.js"),f=e("disk-system:widget/system/util/cache/cacheConfig.js"),v=e("disk-system:widget/system/util/cache/cacheUtils.js"),y=e("disk-system:widget/system/fileService/createNewDir/createNewDir.js"),p=e("disk-system:widget/system/fileService/fileDelete/fileDelete.js"),w=e("disk-system:widget/system/fileService/fileMoveCopy/fileMoveCopy.js"),C=l.tools.shareDirManager,k=window.yunData||{},S="list",I="dir",b="category",M="search",P="cardholder",_="sharedir",V=S,D=".KPDwCE",H="rlcqKJj",L={listViewContainer:".vdAfKMb",gridViewContainer:".JKvHJMb",listViewItem:".AuPKyz",gridViewItem:".cEefyz"},F=!0,B={flagEditing:!1,flagAdding:!1},j={3:"全部图片",2:"全部音乐",4:"全部文档",1:"全部视频",7:"全部种子",6:"其它文件"},x=n(D);location.search.match(/panLoginType=qrcode/)&&l.log.send({name:"login_qrcode",type:"pan_login_qrcode_success"});var A=l.ui.list(D,{defaultViewModle:S,historyConfig:{},listConfig:{defaultScroll:!0,listItemClass:"AuPKyz",itemActiveClass:"rohEvWq"},gridConfig:{defaultScroll:!0,columnWidth:128,gridItemClass:"cEefyz",itemActiveClass:"rohEvWq"},listViewBuilder:u,gridViewBuilder:g});o.setList(A);var E=n(window).height()-x.offset().top;A.resizeScrollBar(E);var N=s.getDefault(),T=new c("list",f.getCacheConfig(),""),$=new c("category",f.getCategoryCacheConfig(),""),J=new c("searchPath",f.getSearchPathCacheConfig(),""),K=new c("searchGlobal",f.getSearchGlobalCacheConfig(),""),G=new c("search",f.getSearchCacheConfig(),""),O=new c("sharedir",f.getShareDirCacheConfig(),""),Y=new y(D);A.onListOrderChange=function(e,t){var i="localorder_"+(k.MYNAME||"").replace(/@/g,""),a="";if(e)a=e+"_"+t,"undefined"!=typeof r&&r.setItem(i,a),l.log.send({type:"listHeaderOrder_"+e,name:"listHeaderOrder",value:e}),l.toolbar.setSortSelect({item:e,desc:t});else if("undefined"!=typeof r&&"function"==typeof r.getItem){a=r.getItem(i);var n=s.getCurrentParams();if("undefined"!=typeof n&&"3"===n.type)return null;if(!a)return null;var o=a.split("_");if(2!==o.length)return null;var c=parseInt(o[1],10),d={item:o[0],desc:c};return l.toolbar.setSortSelect(d),d}},A.getListItemDomByPostion=function(e){{var t=s.getCurrentParams().vmode||"list";A.getCurrentView()}return"list"===t?x.find(".AuPKyz")[e]:"grid"===t?x.find(".cEefyz")[e]:void 0},d.listen("system-load-share-dir-list",function(e){var t=e.dir;t===l.tools.topMountManager.FILE_IDENTITY.SHARE&&(t="/"),O.getCacheData(t,-1,e.complete,{host:e.host,FileTreeView:e.FileTreeView})}),d.listen("system-show-view-mode",function(e){return A.isLocked()?void(e.returnValue=!1):(d.trigger("system-change-view-mode-loadingtip"),void kt(e.type))}),d.listen("header-search",function(e){e+="",e?Ct(e):wt(["/"])}),d.listen("sharedir-access-error",function(){var e=s.getCurrentParams(),t=e.path,i=C.getFakepathInfo(t);i&&i.fakeRootPath&&C.getNameByFakepath(i.fakeRootPath,function(e){l.ui.alert({title:"提示",body:"您已被移出共享文件夹"+e+"，无法继续操作",onSure:function(){var e=c.getCache().sharedir,t=e.data["/"],a=!1;if(t&&t.list&&t.list.length)for(var r=0;r<t.list.length;r++)if(-1===t.list[r].path.indexOf(i)){a=!0;break}location.href=a?"//pan.baidu.com/disk/home#sharedir/path=%2F&vmode=list":"//pan.baidu.com/disk/home#list/path=%2F&vmode=list"}})})}),A.onViewModuleChange=function(e){d.trigger("system-update-view-mode",{type:e}),A.listHeader.changeVmode({type:e})},d.listen("system-newdir",function(){if(Y.flagExists())return void Y.focus();var e=s.getCurrentParams().path,t=s.getCurrentModule(),i=c.checkShareByPath(t,e),a=e,r={path:"/-",server_filename:"-",isdir:1,oper_id:window.yunData.MYUK,share:i,is_root:0,server_mtime:"-"},n=A.cache.cacheName,o=l.tools.topMountManager.getLengthByKey(e);A.setItemsChecked(!1,!0),A.cache.addDataByIndex({obj:r,index:o}),A.refreshList(),e="/"===e?"":e,e+="/新建文件夹",B.flagAdding=!0;var d=l.tools.topMountManager.getLengthByKey(a);Y.show({viewClassName:A.isGridMode()?"miiELm8 fmycqJdD":"",path:e,position:{left:A.isGridMode()?128*o-3:20,top:A.isGridMode()?54:45*o+58},success:function(e,t){t.oper_id=window.yunData.MYUK,t.share=i,t.is_root=0,A.setItemsChecked(!1,!0),c.replaceSingleCache(n,a,t,d)},fail:function(){A.cache.removeByIndex(d),A.refreshList()},complete:function(){B.flagAdding=!1,A.lock(!1)}}),A.lock(!0)});var R=function(e,t){if(Y.flagExists())return void Y.focus();B.flagEditing=!0;var i=(e.path,Y.show({rename:!0,viewClassName:A.isGridMode()?"miiELm8":"",path:e.path,position:t,success:function(t){var i=a.parseFullDirFromPath(e.path);e.path=i+"/"+t;var r=!1;e.server_filename&&t&&e.server_filename.lastIndexOf(".")!==t.lastIndexOf(".")&&(r=!0),e.server_filename=t,e.highlighting&&e.highlighting.filename&&(e.highlighting.filename=t),A.setItemsChecked(!1);var n=v.deleteCacheByMode(V,A.cache,[]);A.getCurrentView().updateBackedData(n.list)},complete:function(){B.flagEditing=!1,A.lock(!1)},cacheMod:A.cache.cacheName}));i&&A.lock(!0)};d.listen("system-rename",function(e){var t=w.manageStatus();if(!t&&!A.isLocked()){var i=e.position,a=e.list;if(!i){var r=A.getCheckedItems();r.length===a.length&&a[0]===A.getCheckedItems()[0]&&(i=A.getCheckedIndexs())}if(i&&i.length>0){A.fixTargetPositionVisible(i[0]);var s=A.getDomByPosition(i[0]);if(!s)return;var o=x.offset(),c=n(s).offset(),l=c.left-o.left+20,d=c.top-o.top;A.isGridMode()&&(d-=7,l-=34),R(a[0],{left:l,top:d})}}});var z=function(e){var t,i=e&&e.path;"undefined"!=typeof e&&e.all===!0?v.removeCacheAll():e&&e.flagChangeSuffix||("undefined"!=typeof i&&(i=i||"/",v.removeCache(i)),V===S?(t=s.getCurrentParams(),i=t.path||"/",i&&v.removeCache(i)):V===b?v.removeCategoryCache():V===M&&v.removeSearchCache()),A.setItemsChecked(!1,!0),A.refreshList()};d.listen("system-refresh",function(e){z(e)});var q=function(e,t,i){p.deleteFiles(e,function(t,a,r){if(0===t){var r=v.deleteCacheByMode(V,A.cache,e);A.setItemsChecked(!1,!0),A.updateLoadingTips(r.hasMore?1:2,r.list.length),A.getCurrentView().updateBackedData(r.list)}"function"==typeof i&&i.call(null,t,a)})};d.listen("system-delete",function(e){var t=w.manageStatus();if(!t&&!A.isLocked()){var i=e.list;i&&i.length>0&&q(i,A.getCheckedIndexs())}});var U=[],W=function(e){if("move"===e){var t=v.deleteCacheByMode(V,A.cache,U);A.setItemsChecked(!1,!0),A.updateLoadingTips(t.hasMore?1:2,t.list.length),A.getCurrentView().updateBackedData(t.list)}else v.deleteCacheByMode(V,A.cache,[])},Q=function(){};d.listen("system-copy",function(e){var t=w.manageStatus();if(!t&&!A.isLocked()){var i=e.list;U=i,i&&i.length>0&&w.showDialog(i,"copy",W,Q)}}),d.listen("system-move",function(e){var t=w.manageStatus();if(!t){var i=w.isNotMoveByPaths(e.list);if(i)return void l.ui.tip({mode:"caution",msg:"预置文件不可以移动"});if(!A.isLocked()){var a=e.list;U=a,a&&a.length>0&&w.showDialog(a,"move",W,Q)}}}),A.onCheckeChanged=function(e){e>1?x.addClass(H):x.removeClass(H)},A.onLockChanged=function(){};var X=!1;A.onLoadedCallBack=function(t,i,r){function o(e,t,i){n.getJSON("/api/report/user?action=sapi_auth&version="+t+"&devuid="+e,function(e){n.isFunction(i)&&i(e)})}if(F){var c=+new Date,u=window.alog;F=!1,setTimeout(function(){"undefined"!=typeof u&&"undefined"!=typeof u.fire&&(u("speed.set","c_pd",c),u.fire("mark"))},1500)}if(r&&r.flag===!1)return void(r&&!k.ISSVIP&&(r.data=t,h.junkFileShow(r)));var g=this.cache.cacheName;if("searchPath"===g&&n(A.getDomByPosition(0)).trigger("dblclick"),"searchGlobal"===g&&0===t.length){var m=s.getCurrentParams().key,f=this.cache.getCache();if(!(f&&f[m]&&f[m].list.length)){if(V=M,m=s.getCurrentParams().key,A.changeCache(G),m+=""){var v=["",m],y=["全部文件",'搜索："'+m+'"'];A.changeHistory(v,y)}else wt(["/"]);Z()}}("list"===g||"sharedir"===g)&&C.initDiffAll(),X||(X=!0,d.callPlugin("网盘引导@com.baidu.pan")),d.trigger("after-list-loaded"),"132"===a.getParam("msg")&&e.async("base:widget/passAPI/passAPI.js",function(e){e.promiseForceverify.done(function(){e.passAPI.PassportForceInit.netdiskForceVerify(),e.passAPI.PassForceverify.onSubmitFailure=function(){},e.passAPI.PassForceverify.onSubmitSuccess=function(){var e=a.getParam("devuid"),t=a.getParam("version");o(e,t,function(e){e&&0===e.errno?setTimeout(function(){window.location.href="/disk/home"},300):l.ui.tip({mode:"caution",msg:"验证失败，请稍后重试！"})})}})}),r&&!k.ISSVIP&&(r.data=t,h.junkFileShow(r))},A.mapFirstFileByCategory=function(e,t){var i=null;if(e.length<=0)return i;i={};var r=A.getFirstPosition();if(0>r)return i;for(var s,o,c=A.getDomByPosition(r),l=null;null!==c&&e.length>0;){if(l=A.getElementDataByPosition(r),l&&!l.isdir&&l.server_filename&&(s=a.getFileCategory(l.server_filename))&&s&&(s="."+s,!i[s]&&(o=n.inArray(s,e))>=0&&(e.splice(o,1),t.call(null,s,n(c)))))return;c=A.getDomByPosition(++r)}},A.getIndexsByFiles=function(e){return A.cache.getIndexsByFiles(e)},A.remove=function(e,t){q(e,null,t)},A.removeCacheByPath=function(e,t,i,a){v.removeCache(e,t,i,a)};var Z=function(){u.clear(),g.clear()},et=function(e,t){var i=s.buildHistory(e,t);N.addHistory(i)},tt=function(e,t){var i=e.vmode;A.setViewModule("grid"===i?"grid":"list",t),l.toolbar.setSortAvailable(e&&"search"===e.type?!1:!0),nt()},it=function(e,t){if("category"===e&&3===t){if(!(k&&k.sampling&&k.sampling.indexOf("disk_timeline")>-1))return void o.instanceForSystem.toolbar.showTimelineDom();var i=a.client().browserString;if(i.match(/ie.+$/)){var r=i.split("ie")[1];if(8>=r)return void l.toolbar.showTimelineDom()}window.location.href="/disk/timeline"}o.instanceForSystem.toolbar.showDefault()},at=function(){var e,t,i=A.onListOrderChange();return i&&(e=i.item,t="number"==typeof i.desc?i.desc:1),[{order:e||"time",desc:void 0!==t?t:1,operateOrderKey:function(){},columns:[{name:"文件名",key:"name",checkbox:!0,width:60},{name:"大小",key:"size",width:16},{name:"修改日期",key:"time",width:23}],module:["list","category"]},{order:"time",desc:1,columns:[{name:"文件名",key:"name",checkbox:!0,width:60,order:!1},{name:"大小",key:"size",width:16,order:!1},{name:"修改日期",key:"time",width:13,order:!1},{name:"所在目录",key:"path-info",width:10,order:!1}],module:["searchPath","searchGlobal","search"]},{order:e||"time",desc:void 0!==t?t:1,operateOrderKey:function(){},columns:[{name:"文件名",key:"name",checkbox:!0,width:50,order:function(){return!("/"===s.getCurrentParams().path)}},{name:"大小",key:"size",width:13,order:function(){return!("/"===s.getCurrentParams().path)}},{name:"创建人",key:"uname",width:13,order:!1},{name:"修改日期",key:"time",width:23,order:function(){return!("/"===s.getCurrentParams().path)}}],module:["sharedir"]}]},rt=function(e){for(var t=at(),i=A.cache&&A.cache.cacheName,a=e.cacheName,r=null,s=[],o=0;o<t.length;o++){if(r=t[o],s=r.module,-1!==n.inArray(i,s)&&-1!==n.inArray(a,s)&&"category"!==a&&"sharedir"!==a)return;if(-1!=n.inArray(a,s))return A.changeHeaderConfig(r),e.config.params.order=r.order,void(e.config.params.desc=r.desc)}},nt=function(){Y&&(B.flagEditing||B.flagAdding)&&Y.cancel()},st=function(e){n("#layoutCardHolder").hide(),n("#layoutMain").show(),u.clear();var t=e.path;"undefined"==typeof t&&(t=""),tt(e),mt(t),it("list",t),Z()},ot=function(e){et(S,e)},ct=function(e){n("#layoutCardHolder").hide(),n("#layoutMain").show();var t=e.type,i=parseInt(t,10);tt(e),ft(i),it("category",i),Z()},lt=function(e){var t=e.key,i=e.searchpath;d.trigger("header-search-val",t),e.type="search",tt(e),i?vt(t,i):yt(t),it("search",t),Z()},dt=function(t){V=S,"/"===t&&(t=""),/\S\/+$/.test(t)&&(t=t.replace(/\/+$/,""));var i=t.split("/"),a=i.slice();i[0]="/",a[0]="全部文件",i[1]&&"cardholder"===i[1]&&(a[1]="我的卡包"),e.async("service-widget-1:widget/cardHolder/list/listInit-sync.js",function(e){e.changeHistory(i,a)})},ht=function(t){var i=t.path;"undefined"==typeof i&&(i=""),dt(i),n("#layoutMain").hide(),n("#layoutCardHolder").show(),t.cardid&&t.type?e.async("service-widget-1:widget/cardHolder/detail/detail-sync.js",function(e){e()}):e.async("service-widget-1:widget/cardHolder/list/listInit-sync.js",function(e){e.init()}),e.async("service-widget-1:widget/cardHolder/list-rmenu/rmenu-sync.js")},ut=s.getCurrentHash();ut&&"cardholder"===ut[0]&&ht(ut[1]);var gt=function(e){u.clear();var t=e.path;"undefined"==typeof t&&(t=""),tt(e),pt(t),it("sharedir",t),Z()},mt=function(e){V=S,rt(T),A.changeCache(T),"/"===e&&(e="");var t=e.split("/"),i=t.slice();t[0]="/",i[0]="全部文件",A.changeHistory(t,i)},ft=function(e){V=b,rt($),A.changeCache($);var t=j[e];if(t){var i=[e],a=[t];A.changeHistory(i,a)}else wt(["/"])},vt=function(e,t){if(V=M,rt(J),A.changeCache(J),e+=""){var i=["",t],a=["全部文件",'搜索："'+e+'"'];A.changeHistory(i,a)}else wt(["/"])},yt=function(e){function t(e){return'<span node-type="leutQXkw" class="text">成为<a class="hkbwQBoL" target="_blank" href="/buy/center?tag=4#FAQ_YEARVIP&amp;from=search" style="text-decoration: underline;" target="_blank">年费会员</a>，尊享全文检索特权，任意搜索office、pdf等文档里面的文字了！</span><a target="_blank"  class="g-button cnlcqMWX" node-type="tgsfEDw0" href="/buy/center?tag=1&usertype='+e+'&from=search"><span class="g-button-right"><span class="text">购买年费会员</span></span></a>'}if(V=M,+k.ISYEARVIP?(rt(K),A.changeCache(K)):(rt(G),A.changeCache(G)),!+k.ISYEARVIP){var i,a,n,s;+k.ISVIP?(s=3,n=r.getItem("search_vip_guide3_"+k.MYNAME),a=t("vip")):(s=1,n=r.getItem("search_vip_guide1_"+k.MYNAME),a=t("novip")),n||(i=l.toolbar.setTipContent({content:a,styleType:1,className:"ktfqJVD",onClose:function(){r.setItem("search_vip_guide"+s+"_"+k.MYNAME,1),l.toolbar.prevDom(!1)}}),l.toolbar.prevDom(i,!0),i.delegate(".hkbwQBoL","click",function(){l.log.send({name:"searchTip",value:"全文检索_会员引导"})}).delegate('a[node-type="tgsfEDw0"]',"click",function(){l.log.send({name:"searchTip",value:"全文检索_会员引导"})}))}if(e+=""){var o=["",e],c=["全部文件",'搜索："'+e+'"'];A.changeHistory(o,c)}else wt(["/"])},pt=function(e){V=_,rt(O),A.changeCache(O),e&&"/"!==e||(e=""),/\S\/+$/.test(e)&&(e=e.replace(/\/+$/,""));var t=e.split("/");t.unshift("all"),t[1]="/";var i=t.slice();i[0]="全部文件",i[1]="共享给我的文件夹";var a=C.getFakepathInfo(i[2]);a?C.getNameByFakepath(i[2],function(e){e?(i[2]=e,A.changeHistory(t,i)):l.ui.alert({title:"提示",body:"您未加入该共享文件夹，无法继续操作",sureText:"知道了",onSure:function(){location.href="/disk/home#list/vmode=list&path=%2F"}})}):A.changeHistory(t,i)};A.extend({getCheckMsg:function(e){return"已选中"+e+"个文件/文件夹"},resizeScrollBar:function(e){var t=this.$container;if("number"==typeof e||"string"==typeof e?t.height(e):e=n(window).height()-t.offset().top,0===e)throw"[Error] list container's height is 0, need to set";var i=this.listHeader.hasInit===!1?0:42;"none"===t.find(".JDeHdxb").css("display")?(this.$moduleGridView.height(e-i),this.$moduleListView.height(e-i),this.$moduleGridView.find(".scrollbar-tracker").height(e-i),this.$moduleListView.find(".scrollbar-tracker").height(e-i)):(this.$moduleGridView.height(e-58),this.$moduleListView.height(e-58),this.$moduleGridView.find(".scrollbar-tracker").height(e-58),this.$moduleListView.find(".scrollbar-tracker").height(e-58))}}),A.addHistory=function(e){var t=A.getHistoryIds();t=t?t.slice():[],t.push(e),V===_?(t.shift(),wt(t,_)):wt(t)},A.goHistory=function(e,t){var i=s.getCurrentParams(),a={};i.vmode&&(a.vmode=i.vmode),t?/\S\/+$/.test(t)&&(t=t.replace(/\/+$/,"")):t="/",a.path=t,et(e,a)},A.historyChange=function(e,t){var i;if(0!==e.length){i=this.currentKey,V===_&&(e=e.slice(1),t=t.slice(1)),this.currentKey=e.join("/"),e.length>1&&(this.currentKey=this.currentKey.substring(1));var a=i!==this.currentKey||this.currentCacheName!==this.cache.cacheName;a&&("/"!==this.currentKey||""!==i||null!==this.currentCacheName&&this.currentCacheName!==this.cache.cacheName||(a=!1)),this.currentCacheName=this.cache.cacheName,a&&this.setItemsChecked(!1,!0),this.cache.updateKey(this.currentKey),this.$historyListRootPath.html(t[0]),this.loadInitData(),a&&this.onHistoryChange(e,t)}},A.listEmptyTip=function(e){var t=s.getCurrentModule(),i=s.getCurrentParams();"sharedir"===t&&i&&"/"===i.path?A.updateListLoading():(A.$listHeader.hide(),e.html(m.emptyView).show())};var wt=function(e,t){V=t||S,1!==e.length&&(e[0]="");var i=s.getCurrentParams(),a={};i.vmode&&(a.vmode=i.vmode);var r=e.join("/");/\S\/+$/.test(r)&&(r=r.replace(/\/+$/,"")),a.path=r,et(V,a)},Ct=function(e){V=M;var t=s.getCurrentParams(),i={};t.vmode&&(i.vmode=t.vmode),i.key=e,et(V,i)},kt=function(e){var t=s.getCurrentParams();t.vmode="grid"===e?"grid":"list",et(V,t)};A.getHistoryList().goToHistory=function(e){if(!(e>=this.historyList.length||0>e)){if(V===M)return d.trigger("header-search-val",""),void wt(["/"]);var t=this.historyList.slice();t.splice(e,this.historyList.length);var i=S;V===_&&(1===t.length&&"all"===t[0]?(t[0]="/",i=S):(t.shift(),i=_)),wt(t,i)}},N.listen(S,st),N.listen(I,ot),N.listen(b,ct),N.listen(M,lt),N.listen(P,ht),1===k.sharedir&&N.listen(_,gt);var St=function(){var e=s.getCurrentHash();return e&&e.length>1&&e[1]&&(e[0]===S&&e[1]&&e[1].path||e[0]===b&&e[1]&&e[1].type||e[0]===M&&e[1]&&e[1].key||e[0]===I&&e[1]&&e[1].path||e[0]===_&&e[1]&&e[1].path)?(V=e[0],!0):!1};St()?(s.interpretCurrentWindow(),d.trigger("system-checked-changed",{data:[]})):ut&&"cardholder"===ut[0]||A.addHistory("/","全部文件");var It=function(){nt(),A.resize(n(window).height()-x.offset().top)};A.listHeader.canTriggerOrder=function(){return!(B.flagEditing||B.flagAdding)},A.cancelEidtingDir=function(){nt()},A.cancelFilesSelect=function(){x.find(".AuPKyz").removeClass("rohEvWq"),x.find(".cEefyz").removeClass("rohEvWq"),A.setItemsChecked(!1,!0)};var bt=function(){var e=-1;n(window).resize(function(){clearTimeout(e),e=setTimeout(function(){It()},300)})};bt(),e.async("disk-system:widget/system/util/mouse-utils/mouse-select.js",function(e){new e({$dom:n(L.listViewContainer),item:L.listViewItem,viewMod:"list",selectClass:"rohEvWq",list:A,canSelect:function(){return A.isLocked()?!1:void 0},onEnd:function(){l.log.send({name:"web_mouseSelect",value:"框选"})}}),new e({$dom:n(L.gridViewContainer),item:L.gridViewItem,vieMod:"grid",selectClass:"rohEvWq",list:A,canSelect:function(){return A.isLocked()?!1:void 0},onEnd:function(){l.log.send({name:"web_mouseSelect",value:"框选"})}})});var Mt=function(e){var t=A.getCheckedItems();U=t,w.moveTo(t,e.path,W,Q),l.log.send({name:"web_mouseDrag",value:"拖拽"})};e.async("disk-system:widget/system/util/mouse-utils/mouse-drag.js",function(e){new e({$dom:n(L.listViewContainer),item:L.listViewItem,viewMod:"list",selectClass:"rohEvWq",list:A,onDragEndCallback:Mt}),new e({$dom:n(L.gridViewContainer),item:L.gridViewItem,viewMod:"grid",selectClass:"rohEvWq",list:A,onDragEndCallback:Mt})});var Pt=function(e){"move"===e||"delete"===e?(v.removeCache(A.cache.getKey(),e),A.refreshList()):(v.removeCacheByKey("list"),A.refreshList())};setTimeout(function(){if("undefined"!=typeof r&&"function"==typeof r.getItem){var e,t="asynfilemanager_"+(k.MYNAME||"").replace(/@/g,""),i=r.getItem(t);i&&2===(e=i.split("_")).length&&(r.removeItem(t),w.resolveHasTask(e[0],e[1],function(e,t,i,a){1!==e&&3!==e||!a||Pt(a.operate)}))}},1500);var _t=function(){var e=document.referrer,t="fm_self",i=/(http|https):\/\/(tieba|hao123)\.baidu\.com/gi,a=/(http|https):\/\/www\.hao123\.com/gi;return"string"==typeof e&&e.length>0&&(t=i.test(e)?"fm_"+RegExp.$2:a.test(e)?"fm_hao123":-1!==e.indexOf("http://www.baidu.com/s?wd=")?"fm_baidups":"fm_not_proved"),t};l.log.sendUserReport(_t()),k.ISSVIP||h.duplicateCheck(),i.exports=A});
;define("disk-system:widget/pageModule/toolbar/search.js",function(e,r,a){var c=e("base:widget/libs/jquerypacket.js"),s=e("base:widget/historyManager/historyManager.js"),n=e("system-core:context/context.js").instanceForSystem,t={obj:{timer:null,isSearchIng:!1},q:{searchQuery:'.OFaPaO input[node-type="jnQVWW pnwhEvoZ"]',searchBtn:'.OFaPaO  span[node-type="pnwhEvoZ"]',searchPlaceHolder:'.OFaPaO  span[node-type="kjfmqJ9J"]',searchClear:'.OFaPaO  span[node-type="gplqM06"]'},util:{doSearch:function(){var e=s.getDefault(),r=c.trim(c(t.q.searchQuery).val());if(""===r)return!1;var a=s.buildHistory("search",{key:r});n.log.send({name:"searchValue",value:r}),t.isSearchIng||(t.isSearchIng=!0,t.obj.timer=setTimeout(function(){e.addHistory(a),t.isSearchIng=!1,clearTimeout(t.obj.timer)},100))},unSearch:function(){var e=s.getDefault(),r=s.buildHistory("list",{key:"/"});e.addHistory(r)}},bindEvent:function(){c(t.q.searchQuery).on("keydown",function(e){return 13===e.keyCode?(t.util.doSearch(),!1):void 0}),c(t.q.searchBtn).on("click",function(){return t.util.doSearch(),!1}),c(t.q.searchQuery).on("focus",function(){""===c.trim(c(t.q.searchQuery).val())?c(t.q.searchPlaceHolder).hide():c(t.q.searchClear).show()}),c(t.q.searchQuery).on("input",function(){""===c.trim(c(t.q.searchQuery).val())?c(t.q.searchClear).hide():c(t.q.searchClear).show()}),c(t.q.searchQuery).on("blur",function(){setTimeout(function(){""===c.trim(c(t.q.searchQuery).val())&&(c(t.q.searchPlaceHolder).show(),c(t.q.searchClear).hide())},100)}),c(t.q.searchPlaceHolder).on("click",function(){c(t.q.searchQuery).focus()}),c(t.q.searchClear).on("click",function(){c(t.q.searchQuery).val(""),c(t.q.searchPlaceHolder).show(),c(t.q.searchClear).hide(),t.util.unSearch()})},init:function(){t.bindEvent()}};t.init();var i={};a.exports=i});
;define("disk-system:widget/pageModule/toolbar/toolbar.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),i=(e("base:widget/storage/storage.js"),e("system-core:data/faceData.js").getData()),s=e("disk-system:widget/system/uiRender/buttonBox/buttonBox.js"),o=e("disk-system:widget/pageModule/toolbar/sort.js"),n=e("base:widget/hash/hash.js"),a=e("system-core:context/context.js"),d=a.instanceForSystem,l=d.message,r=a.instanceForSystem.tools.shareDirManager,c=t(".DxdbeCb"),h={listGridSwitch:".ryvhP50g",listSwitch:".ehoqn44",gridSwitch:".pfPRje",prevDom:".gfwrPN0x",afterDom:".wikhqjnm",defaultDom:".hjP5wr",userDom:".zkE49l",timeLineDom:".EQBfLM",listTools:".QDDOQB",defaultListToolPos:".KPDwCE .KKtwaH",bar:".qhP7DL"},m=new s({name:"tools",className:"tcuLAu",container:c.find(".qhP7DL"),buttons:i.getButton("tools"),alwaysShow:!0,autoWidth:!0,spareWidth:435,paddingLeft:0,limit:4,disableFun:{shareDirButtonCheck:r.shareDirButtonCheck}}),f=new s({name:"listTools",className:"QDDOQB",limit:8,outSize:36,resize:!0,container:c.find(".qhP7DL"),buttons:i.getButton("listTools"),disableFun:{shareDirButtonCheck:r.shareDirButtonCheck}});f.hide();var u=function(e){"undefined"!=typeof localStorage&&localStorage.setItem("chooseviewtype",e)};c.on("click",h.listSwitch,function(){if(!t(this).parent().hasClass("uwpcqoD4")){d.log.send({name:"vmodeSwitch"});var e={type:"list"};u("list"),l.trigger("system-show-view-mode",e)}}),c.on("click",h.gridSwitch,function(){if(!t(this).parent().hasClass("wuPY2R")){d.log.send({name:"vmodeSwitch"});var e={type:"grid"};u("grid"),l.trigger("system-show-view-mode",e)}}),l.listen("system-update-view-mode",function(e){var t=c.find(h.listGridSwitch);"list"===e.type?(t.addClass("uwpcqoD4").removeClass("wuPY2R"),t.find("a[node-type=uniPYRk]").hide(),t.find("a[node-type=lbgPl2O]").show()):(t.removeClass("uwpcqoD4").addClass("wuPY2R"),t.find("a[node-type=uniPYRk]").show(),t.find("a[node-type=lbgPl2O]").hide())}),l.listen("system-checked-changed",function(e){var i=n.get("category/type");"3"!==i&&m.filesSelect(e.data);var s=t(".tcuLAu").width();"3"===i&&(s=160),f.filesSelect(e.data,{paddingLeft:s})}),l.listen("system-change-toolbar",function(){var e=a.getList().getCheckedItems();m.resizeButtons(e)}),l.listen("system-update-list-operate",function(){var e=a.getList().getCheckedItems();f.resizeButtons(e)});var p=!1,g=!1;a.extend({toolbar:{afterDom:function(e,i){if(e){if(g)return;i===!0&&(g=!0),c.find(h.afterDom).html("").append(e).show()}else e===!1?(c.find(h.afterDom).html(""),g=!1):c.find(h.afterDom).hide();t(window).trigger("resize")},prevDom:function(e,i){if(e){if(p>i)return;(i===!0||"number"==typeof i)&&(p=i>1?i:1),c.find(h.prevDom).html("").append(e).show()}else e===!1?(c.find(h.prevDom).html(""),p=!1):c.find(h.prevDom).hide();t(window).trigger("resize")},setStyle:function(e,t){e&&(0===t?e.addClass("ptruqp1e"):1===t&&e.addClass("ptruqp1e alEa2B"))},setTipContent:function(e){e=t.extend({content:null,styleType:null,className:null,onClose:function(){}},e);var i=t('<div node-type="jhqn5l" class="global-clearfix"><a node-type="jxPR10" href="javascript:void(0);" class="ehPb6a"></a></div>');return null!=e.styleType&&this.setStyle(i,e.styleType),null!=e.className&&i.addClass(e.className),null!=e.content&&i.append(e.content),"function"==typeof e.onClose&&i.find(".ehPb6a").click(function(){e.onClose()}),i},showDefault:function(){c.find(h.userDom).hide(),c.find(h.defaultDom).show(),c.find(h.prevDom).children().length&&c.find(h.prevDom).show(),c.find(h.afterDom).children().length&&c.find(h.afterDom).show(),c.find(h.timeLineDom).hide(),c.removeClass("ytbqK1b");var e=t(h.defaultListToolPos).find(h.listTools);e.length&&e.appendTo(c.find(h.bar)),m.onVisibilityChange(!0)},setDom:function(e){c.find(h.defaultDom).hide(),c.find(h.prevDom).hide(),c.find(h.afterDom).hide(),c.find(h.timeLineDom).hide(),c.find(h.userDom).html("").append(e).show(),c.removeClass("ytbqK1b"),t(window).trigger("resize")},showTimelineDom:function(){if(yunData&&yunData.sampling&&yunData.sampling.indexOf("disk_timeline")>-1){var e=this,i='<div style="text-align:left;">温馨提示：你的浏览器版本过低，无法体验图片等新功能，请升级为IE8以上浏览器</div>',s=e.setTipContent({content:i,className:"update-browser-tips",styleType:1,onClose:function(){e.prevDom(!1)}});e.prevDom(s,!0),t(window).one("hashchange",function(){e.prevDom(!1)})}else c.find(h.prevDom).hide();c.find(h.defaultDom).hide(),c.find(h.afterDom).hide(),c.find(h.userDom).hide(),c.find(h.timeLineDom).show(),c.addClass("ytbqK1b"),t(window).trigger("resize");var o=c.find(h.listTools);o.length&&o.appendTo(t(h.defaultListToolPos))},setSortSelect:function(e){o.setSortSelect(e)},setSortAvailable:function(e){o.setSortAvailable(e)}}})});
;define("disk-system:widget/pageModule/aside/aside.js",function(e){var t=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/hash/hash.js"),a=e("system-core:data/faceData.js").getData(),s=e("system-core:system/baseService/message/message.js"),n=(e("base:widget/tools/tools.js"),e("system-core:context/context.js")),o=e("disk-system:widget/system/uiRender/buttonBox/buttonBox.js"),d=e("base:widget/historyManager/historyManager.js"),c=e("base:widget/storage/storage.js"),r={mod:".module-aside",listItem:'li[node-type~="vafdqnn4"]',picHotIco:'em[node-type~="xhfPRee"]',picItem:'a[node-type~="yePYAR"]',itemTitle:'span[node-type~="flPlR5"]',imgIcon:'span[node-type~="ujdqjxm"]',itemHref:'a[node-type~="azrgE4dl"]'},l=t(r.mod),m=function(){var e='<li node-type="vafdqnn4" class="oxuuqp4e"><a node-type="azrgE4dl" class="nzirqgv1" hideFocus="true" href="javascript:void(O);"><span class="text"><span node-type="ujdqjxm" class="srpQABE"></span><span node-type="flPlR5"></span></span></a></li>';return e},p=function(){var e=function(e,i){var a,s;if(i.isVisible===!1?e.hide():e.show(),i.title&&e.find(r.itemTitle).text(i.title),i.iconClass&&e.find(r.imgIcon).addClass(i.iconClass),i.href&&e.find(r.itemHref).attr("href",i.href).removeAttr("cat"),i.guide){if(a=i.guide,"object"!=typeof a)throw new Error("[aside] The new nav item must has property: guide. And the guide must be an object");a.dom&&(s=t(a.dom),a.positionX&&s.css("left",a.positionX),a.positionY&&s.css("top",a.positionY),e.find(r.itemHref).append(s))}i.click&&"function"==typeof i.click&&e.bind("click",function(e){i.click.call(s,e)})};s.listen("nav-add-item",function(i){var a=t(r.listItem),s=t(m());e(s,i),i.index&&i.index<a.length?a.eq(i.index).after(s):a.last().after(s)}),s.listen("nav-change-item",function(i){var a,s=t(r.listItem);if(!(i.index&&i.index<s.length))throw new Error("[aside] The index of item which you will change must in the range of 0 ~ "+s.length);a=s.eq(i.index),e(a,i)})},g=function(){l.delegate(r.listItem,"mouseover",function(e){var i=t(e.target).closest(r.listItem);i.addClass("vgKGgu")}),l.delegate(r.listItem,"mouseout",function(e){var i=t(e.target).closest(r.listItem);i.removeClass("vgKGgu")}),l.delegate(r.listItem,"click",function(e){var i=c.getItem("chooseviewtype")||"list",a=t(e.target).closest(r.listItem);if(a.hasClass("bHzsaPb")&&"all"!==a.data("key"))return!1;l.find(r.listItem).removeClass("bHzsaPb"),a.addClass("bHzsaPb"),n.instanceForSystem.log.send({type:"leftSideNavigator_"+a.data("key"),value:a.data("key")});var s=t(e.target).closest("a").attr("cat"),o=t(e.target).closest("a").attr("path");return s?(d.getDefault().addHistory("category/type="+s+"&vmode="+i),!1):o?(d.getDefault().addHistory("list/path="+encodeURIComponent(o)+"&vmode="+i),!1):void 0})},f=function(){var e,t=n.instanceForSystem.pageInfo.currentPage,a=l.find(r.listItem),s=i.get("category/type"),o=i.get("path"),d=i.get("key"),m=i.get("vmode");if("disk-home"===t){var p=c.getItem("chooseviewtype")||"list";if(m||setTimeout(function(){i.set("vmode",p)},0),o&&""!==o||d&&""!==d)e="all";else switch(s){case"4":e="doc";break;case"1":e="video";break;case"7":e="mbt";break;case"2":e="music";break;case"3":e="pic";break;case"6":e="other";break;default:e="all"}}switch(t){case"recyclebin":e="recyclebin";break;case"share-manage":e="share";break;case"disk-pic":e="pic"}a.removeClass("bHzsaPb");for(var g=0;g<a.length;g++)a.eq(g).data("key")===e&&a.eq(g).addClass("bHzsaPb")},u=function(){c.getItem("redPointNotice")||t.ajax({url:"/api/image/getreddot",dataType:"json",success:function(e){e.isdot===!0&&(t('li[data-key="pic"]').append('<div class="qegxqKjE" node-type="tpE9yY"></div>'),t('li[data-key="pic"]').one("click",function(){t('div[node-type="tpE9yY"]')&&t('li[data-key="pic"]').remove(t('div[node-type="tpE9yY"]'))}),c.setItem("redPointNotice",!0))}})},y=function(){g(),f(),p(),u(),i.listen("category/type, path, key",function(){f()});new o({name:"aside-middle",className:"nrQ0oP",buttons:a.getButton("aside-middle"),container:l.find(".FvBGOQ")}),new o({name:"aside-bottom",className:"rnExpE",buttons:a.getButton("aside-bottom"),container:l.find(".JKEQDvb")});l.find(".FvBGOQ").prev(".ypqlqz5E").show(),l.find(".JKEQDvb").prev(".ypqlqz5E").show(),s.callPlugin("网盘图片时间轴@com.baidu.pan"),s.trigger("aside-render-finish")};n.extend({nav:{addItem:function(e){s.trigger("nav-add-item",e)},changeItem:function(e){s.trigger("nav-change-item",e)}}}),y()});
;define("disk-system:widget/system/uiRender/paint/paint.js",function(t){function e(t,e){n.call(this),this.layoutElement=a(t),e||(e={}),this.contentElement=e.putSubIn?a(e.putSubIn):this.layoutElement,e.hasSubLayout&&this.onAddingSubLayout(),this.absoluteContainer=null}function s(){this.app=new e("#layoutApp"),this.aside=new e("#layoutAside",{hasSubLayout:!0,putSubIn:a(".module-aside")}),this.main=new e("#layoutMain",{hasSubLayout:!0}),this._initLayouts()}var i=t("system-core:data/faceData.js").getData(),a=t("base:widget/libs/jquerypacket.js"),o=t("base:widget/libs/underscore.js"),n=t("base:widget/tools/service/tools.event.js").EventEmitter,r=t("base:widget/tools/service/tools.util.js"),u=t("system-core:system/baseService/message/message.js");r.inherits(e,n),e.prototype.onMainLayoutChange=function(t,e){"top"===t||"bottom"===t?e=e[1]:("right"===t||"left"===t)&&(e=e[0]);var s=this.layoutElement.css(t);e=parseInt(s,10)+parseInt(e,10),isNaN(e)||this.layoutElement.css(t,e+"px")},e.prototype.onAddingSubLayout=function(){function t(t,e){this.contentElement.prepend(e)}function e(t,e,s){if(s){if(!this.absoluteContainer&&"bottom"===t){var i=!0;this.absoluteContainer=a("<div>").addClass("aside-absolute-container").css({visibility:"hidden",position:"absolute",width:"100%"})}var o=this.absoluteContainer.height();this.absoluteContainer.height(o+e.height()),this.absoluteContainer.append(e),i&&this.absoluteContainer.appendTo(this.contentElement)}else this.contentElement.append(e)}this.on("top",t),this.on("left",t),this.on("bottom",e),this.on("right",e)},s.prototype={constructor:s,_initLayouts:function(){var t=this;u.listen("aside-render-finish",function(){var e=t.aside.contentElement,s=t.aside.layoutElement.css("bottom");s=parseInt(s,10),isNaN(s)&&(s=0);var i=e.find(".aside-absolute-container");if(i.length){var n=o.throttle(function(){window.setTimeout(function(){var t=a(window).height(),o=e.offset();i.css("visibility","visible"),t-o.top-s-i.height()<406?(i.css("top","406px"),i.css("bottom","auto")):(i.css("top","auto"),i.css("bottom","50px"))},0)},300);n(),a(window).bind("resize",n)}if(a.browser.msie===!0&&6==a.browser.version){var r=o.throttle(function(){a("#layoutApp").height(a(window).height())},300);a(window).bind("resize",r),r()}})},_createSubLayout:function(t){var e=document.createElement("div");return"app"!==t.area&&(e.style.width=t.width,e.style.height=t.height,e.style.background=t.bg),(t.zIndex||0===t.zIndex)&&a(e).css({"z-index":t.zIndex}),t.containerId&&(e.id=t.containerId),t.className&&(e.className=t.className),t.absolute&&(e.style.position="absolute"),t.absolute&&(this[t.area][t.pos+"Offset"]||(this[t.area][t.pos+"Offset"]=0),e.style[t.pos]=this[t.area][t.pos+"Offset"]+"px",this[t.area][t.pos+"Offset"]+=parseInt(t.height,10)),a(e)},addLayout:function(t){if(!t.area)throw new Error("no area property, ERROR!");var e=t.size.split("*");if(2!==e.length)throw new Error("wrong size property: ERROR!");var s=this._createSubLayout({width:e[0],height:e[1],bg:t.background,pos:t.position,area:t.area,absolute:t.absolute,zIndex:t.zIndex,containerId:t.containerId,className:t.className});"app"===t.area?this.app.layoutElement.append(s):this[t.area].emit(t.position,t.position,s,t.absolute),u.trigger("plugin:"+t.pluginId,{$container:s})},addLayoutByList:function(t){o.each(t,function(t){t.delay!==!0&&this.addLayout(t)},this)}},(new s).addLayoutByList(i.interface)});
;define("disk-system:widget/system/util/contextExtend.js",function(e){var t=e("system-core:context/context.js").instanceForSystem,i=e("disk-system:widget/data/yunData.js"),n=e("disk-system:widget/system/fileService/fileOperate/fileOperate.js"),s=e("system-core:system/uiService/list/list.js"),r=e("system-core:system/uiService/dialog/dialog.js"),o=e("system-core:system/uiService/button/button.js"),a=e("disk-system:widget/system/baseService/payFactory/payFactory.js"),d=e("disk-system:widget/system/baseService/shareDir/shareDirManager.js"),g=e("disk-system:widget/system/baseService/topMountManager.js");e("disk-system:widget/system/errorMsg/errorMsg.js");var u={buttonType:"big",buttonPadding:["50px","50px"],buttonColor:"blue"},c={paddingLeft:10,paddingRight:10,height:34};t.extend({file:{getIconAndPlugin:function(e,t,i,s){return n.getInfo(e,t,!1,i,s)},isOpenedFile:function(e,t){return n.isOpenedFile(e,t)},getFileInfo:function(e,t,i,s,r){return n.getInfo(e,t,i,s,r)}},data:{user:i.get(),quota:{get:function(){return[100,1e10]},update:function(e){e(100,1e10)},hasEnoughSpacing:function(){return window.yunData&&window.yunData.QUOTAINFOS?window.yunData.QUOTAINFOS.used<window.yunData.QUOTAINFOS.total:!0}}},ui:{treeDialog:function(i){e.async("disk-system:widget/system/uiService/fileTreeDialog/fileTreeDialog.js",function(e){i===!1?e.hide():e.show(i)}),t.message.trigger("addIcon")},list:function(e,t){var i=new s(e,t);return i.extend({resizeScrollBar:function(e){var t=this.$container;if("number"==typeof e||"string"==typeof e?t.height(e):e=t.height(),0===e)throw"[Error] list container's height is 0, need to set";t.height(e);var i=this.listHeader.hasInit===!1?0:52,n=t.find(".module-list-view"),s=t.find(".module-grid-view"),r=n.add(s);"none"===t.find(".module-history-list").css("display")?r.height(e-i).find(".scrollbar-tracker").height(e-i-2):r.height(e-73).find(".scrollbar-tracker").height(e-73)}}),i},window:function(e){var i=new r(e);return t.message.trigger("addIcon"),i},confirm:function(e,i,n,s,o){var a=r.confirm(e,i,n,s,o,u);return t.message.trigger("addIcon"),a},alert:function(e,i){var n=r.alert(e,i,u);return t.message.trigger("addIcon"),n},verify:function(e,i,n,s,o){var a=r.verify(e,i,n,s,o,u);return t.message.trigger("addIcon"),a},button:function(e){return e.buttonDefaultConfig=c,new o(e)}},tools:{payFactory:a,shareDirManager:d,topMountManager:g}})});
;define("disk-system:widget/start/start.js",function(s){s("disk-system:widget/data/yunData.js"),s("disk-system:widget/system/util/contextExtend.js"),s("disk-system:widget/system/uiRender/paint/paint.js"),s("disk-system:widget/pageModule/aside/aside.js"),s("disk-system:widget/pageModule/toolbar/toolbar.js"),s("disk-system:widget/pageModule/toolbar/sort.js"),s("disk-system:widget/pageModule/toolbar/search.js"),s("disk-system:widget/pageModule/list/listInit.js"),s("disk-system:widget/system/uiRender/menu/menu.js")});